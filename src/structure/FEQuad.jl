module FEQuad

using LinearAlgebra
using SparseArrays
using Logging

using HCubature

using ...CoordinateSystem
import ..FENode

export Quad

mutable struct Quad
    id::String
    hid::Int

    node1
    node2
    node3
    node4
    material
    t::Float64

    membrane::Bool
    bending::Bool

    center::Array{Float64}
    A::Float64
    T::SparseMatrixCSC{Float64}

    Kmᵉ::SparseMatrixCSC{Float64}
    Kbᵉ::SparseMatrixCSC{Float64}

    Kᵉ::SparseMatrixCSC{Float64}
    Mᵉ::SparseMatrixCSC{Float64}
end

function Quad(id,hid,node1,node2,node3,node4,material,t;membrane=true,bending=true)
    #Initialize local CSys,could be optimized by using a MSE plane
    o=(node1.loc+node2.loc+node3.loc+node4.loc)/4
    pt1 = node1.loc+node2.loc
    pt2 = node2.loc+node3.loc
    csys = CSys(o, pt1, pt2)

    vertices=[n.loc for n in (node1,node2,node3,node4)]
    #check aspect ratio
    a=vertices[1]-vertices[3]
    b=vertices[2]-vertices[4]
    if !(0.1<norm(a)/norm(b)<10)
        @warn "Quad "*string(id)*" has an aspect ratio larger than 10, may lead to element illness."
    end
    #check wrong sequence
    for i in 1:4
        j=i%4+1
        if (vertices[i]-o)×(vertices[j]-o)⋅csys.T[:,3]<0
            @warn  "Quad "*string(id)*" has a wrong sequence of nodes, may lead to element illness."
            break
        end
    end
    #check devolution vertex
    for i in 1:4
        j=i%4+1
        if norm(vertices[i]-vertices[j])<1e-9
            @warn  "Quad "*string(id)*" has only 3 independent nodes, may lead to element illness."
            break
        end
    end
    #check distorsion
    for i in 1:4
        v=vertices[i]-o
        if (v⋅csys.T[:,3]/norm(csys.T[:,3]))/norm(v)>0.1
            @warn  "Quad "*string(id)*" is too distorted, may lead to element illness."
            break
        end
    end
    #check convexness
    for i in 1:4
        j=(i+1)%4+1
        k=i%4+1
        if norm((vertices[i]+vertices[j])/2-o)>=norm(vertices[k]-o)
            @warn  "Quad "*string(id)*" is not convex, may lead to element illness."
            break
        end
    end

    #area is considered as the average of trangles generated by splitting the quand with diagonals
    A=0.5*det([[1;1;1] node2.loc-node1.loc node3.loc-node1.loc]')
    A+=0.5*det([[1;1;1]  node4.loc-node1.loc node3.loc-node1.loc]')
    A+=0.5*det([[1;1;1] node4.loc-node1.loc node2.loc-node1.loc]')
    A+=0.5*det([[1;1;1] node4.loc-node2.loc node3.loc-node2.loc]')
    A/=4

    E=material.E
    ν=material.ν

    #3D to local 2D
    T=zeros(24,24)
    for i in 8
        T[3i-2:3i,3i-2:3i]=csys.T
    end
    T=sparse(T)

    Kbᵉ=spzeros(1,1)
    Kmᵉ=spzeros(1,1)

    Kᵉ=spzeros(1,1)
    Mᵉ=spzeros(1,1)

    Quad(id,hid,node1,node2,node3,node4,material,t,membrane,bending,o,A,T,Kbᵉ,Kmᵉ,Kᵉ,Mᵉ)
end

function integrateKm!(elm)
    E₀,ν₀=elm.material.E,elm.material.ν
    center=elm.center
    t=elm.t
    T=elm.T[1:3,1:3]
    x₁,y₁,z₁=T*(elm.node1.loc-center)
    x₂,y₂,z₂=T*(elm.node2.loc-center)
    x₃,y₃,z₃=T*(elm.node3.loc-center)
    x₄,y₄,z₄=T*(elm.node4.loc-center)
    K=Matrix{Float64}(undef,8,8)
    J=Matrix{Float64}(undef,2,2)

    function BtDB(x)
        ξ,η=x[1],x[2]
        # include(joinpath(dirname(@__FILE__),"k_memb.jl"))
        # include(joinpath(dirname(@__FILE__),"jacobi.jl"))
        K[1,1]=(1/16)*(1 - η)^2*E₀/(1 - ν₀^2) + (1/32)*(1 - ξ)^2*E₀*(1 - ν₀)/(1 - ν₀^2)
        K[1,2]=(1/16)*(1 - ξ)*(1 - η)*E₀*ν₀/(1 - ν₀^2) + (1/32)*(1 - ξ)*(1 - η)*E₀*(1 - ν₀)/(1 - ν₀^2)
        K[1,3]=(1/16)*(1 - η)*(1 + η)*E₀/(1 - ν₀^2) + (-1/32)*(1 - ξ)^2*E₀*(1 - ν₀)/(1 - ν₀^2)
        K[1,4]=(-1/16)*(1 - ξ)*(1 - η)*E₀*ν₀/(1 - ν₀^2) + (1/32)*(1 - ξ)*(1 + η)*E₀*(1 - ν₀)/(1 - ν₀^2)
        K[1,5]=(-1/16)*(1 - η)^2*E₀/(1 - ν₀^2) + (1/32)*(1 - ξ)*(1 + ξ)*E₀*(1 - ν₀)/(1 - ν₀^2)
        K[1,6]=(-1/32)*(1 - ξ)*(1 - η)*E₀*(1 - ν₀)/(1 - ν₀^2) + (1/16)*(1 + ξ)*(1 - η)*E₀*ν₀/(1 - ν₀^2)
        K[1,7]=(-1/16)*(1 - η)*(1 + η)*E₀/(1 - ν₀^2) + (-1/32)*(1 - ξ)*(1 + ξ)*E₀*(1 - ν₀)/(1 - ν₀^2)
        K[1,8]=(-1/32)*(1 - ξ)*(1 + η)*E₀*(1 - ν₀)/(1 - ν₀^2) + (-1/16)*(1 + ξ)*(1 - η)*E₀*ν₀/(1 - ν₀^2)
        K[2,1]=(1/16)*(1 - ξ)*(1 - η)*E₀*ν₀/(1 - ν₀^2) + (1/32)*(1 - ξ)*(1 - η)*E₀*(1 - ν₀)/(1 - ν₀^2)
        K[2,2]=(1/16)*(1 - ξ)^2*E₀/(1 - ν₀^2) + (1/32)*(1 - η)^2*E₀*(1 - ν₀)/(1 - ν₀^2)
        K[2,3]=(-1/32)*(1 - ξ)*(1 - η)*E₀*(1 - ν₀)/(1 - ν₀^2) + (1/16)*(1 - ξ)*(1 + η)*E₀*ν₀/(1 - ν₀^2)
        K[2,4]=(-1/16)*(1 - ξ)^2*E₀/(1 - ν₀^2) + (1/32)*(1 - η)*(1 + η)*E₀*(1 - ν₀)/(1 - ν₀^2)
        K[2,5]=(-1/16)*(1 - ξ)*(1 - η)*E₀*ν₀/(1 - ν₀^2) + (1/32)*(1 + ξ)*(1 - η)*E₀*(1 - ν₀)/(1 - ν₀^2)
        K[2,6]=(-1/32)*(1 - η)^2*E₀*(1 - ν₀)/(1 - ν₀^2) + (1/16)*(1 - ξ)*(1 + ξ)*E₀/(1 - ν₀^2)
        K[2,7]=(-1/16)*(1 - ξ)*(1 + η)*E₀*ν₀/(1 - ν₀^2) + (-1/32)*(1 + ξ)*(1 - η)*E₀*(1 - ν₀)/(1 - ν₀^2)
        K[2,8]=(-1/16)*(1 - ξ)*(1 + ξ)*E₀/(1 - ν₀^2) + (-1/32)*(1 - η)*(1 + η)*E₀*(1 - ν₀)/(1 - ν₀^2)
        K[3,1]=(1/16)*(1 - η)*(1 + η)*E₀/(1 - ν₀^2) + (-1/32)*(1 - ξ)^2*E₀*(1 - ν₀)/(1 - ν₀^2)
        K[3,2]=(-1/32)*(1 - ξ)*(1 - η)*E₀*(1 - ν₀)/(1 - ν₀^2) + (1/16)*(1 - ξ)*(1 + η)*E₀*ν₀/(1 - ν₀^2)
        K[3,3]=(1/16)*(1 + η)^2*E₀/(1 - ν₀^2) + (1/32)*(1 - ξ)^2*E₀*(1 - ν₀)/(1 - ν₀^2)
        K[3,4]=(-1/16)*(1 - ξ)*(1 + η)*E₀*ν₀/(1 - ν₀^2) + (-1/32)*(1 - ξ)*(1 + η)*E₀*(1 - ν₀)/(1 - ν₀^2)
        K[3,5]=(-1/16)*(1 - η)*(1 + η)*E₀/(1 - ν₀^2) + (-1/32)*(1 - ξ)*(1 + ξ)*E₀*(1 - ν₀)/(1 - ν₀^2)
        K[3,6]=(1/32)*(1 - ξ)*(1 - η)*E₀*(1 - ν₀)/(1 - ν₀^2) + (1/16)*(1 + ξ)*(1 + η)*E₀*ν₀/(1 - ν₀^2)
        K[3,7]=(-1/16)*(1 + η)^2*E₀/(1 - ν₀^2) + (1/32)*(1 - ξ)*(1 + ξ)*E₀*(1 - ν₀)/(1 - ν₀^2)
        K[3,8]=(1/32)*(1 - ξ)*(1 + η)*E₀*(1 - ν₀)/(1 - ν₀^2) + (-1/16)*(1 + ξ)*(1 + η)*E₀*ν₀/(1 - ν₀^2)
        K[4,1]=(-1/16)*(1 - ξ)*(1 - η)*E₀*ν₀/(1 - ν₀^2) + (1/32)*(1 - ξ)*(1 + η)*E₀*(1 - ν₀)/(1 - ν₀^2)
        K[4,2]=(-1/16)*(1 - ξ)^2*E₀/(1 - ν₀^2) + (1/32)*(1 - η)*(1 + η)*E₀*(1 - ν₀)/(1 - ν₀^2)
        K[4,3]=(-1/16)*(1 - ξ)*(1 + η)*E₀*ν₀/(1 - ν₀^2) + (-1/32)*(1 - ξ)*(1 + η)*E₀*(1 - ν₀)/(1 - ν₀^2)
        K[4,4]=(1/16)*(1 - ξ)^2*E₀/(1 - ν₀^2) + (1/32)*(1 + η)^2*E₀*(1 - ν₀)/(1 - ν₀^2)
        K[4,5]=(1/16)*(1 - ξ)*(1 - η)*E₀*ν₀/(1 - ν₀^2) + (1/32)*(1 + ξ)*(1 + η)*E₀*(1 - ν₀)/(1 - ν₀^2)
        K[4,6]=(-1/16)*(1 - ξ)*(1 + ξ)*E₀/(1 - ν₀^2) + (-1/32)*(1 - η)*(1 + η)*E₀*(1 - ν₀)/(1 - ν₀^2)
        K[4,7]=(1/16)*(1 - ξ)*(1 + η)*E₀*ν₀/(1 - ν₀^2) + (-1/32)*(1 + ξ)*(1 + η)*E₀*(1 - ν₀)/(1 - ν₀^2)
        K[4,8]=(-1/32)*(1 + η)^2*E₀*(1 - ν₀)/(1 - ν₀^2) + (1/16)*(1 - ξ)*(1 + ξ)*E₀/(1 - ν₀^2)
        K[5,1]=(-1/16)*(1 - η)^2*E₀/(1 - ν₀^2) + (1/32)*(1 - ξ)*(1 + ξ)*E₀*(1 - ν₀)/(1 - ν₀^2)
        K[5,2]=(-1/16)*(1 - ξ)*(1 - η)*E₀*ν₀/(1 - ν₀^2) + (1/32)*(1 + ξ)*(1 - η)*E₀*(1 - ν₀)/(1 - ν₀^2)
        K[5,3]=(-1/16)*(1 - η)*(1 + η)*E₀/(1 - ν₀^2) + (-1/32)*(1 - ξ)*(1 + ξ)*E₀*(1 - ν₀)/(1 - ν₀^2)
        K[5,4]=(1/16)*(1 - ξ)*(1 - η)*E₀*ν₀/(1 - ν₀^2) + (1/32)*(1 + ξ)*(1 + η)*E₀*(1 - ν₀)/(1 - ν₀^2)
        K[5,5]=(1/16)*(1 - η)^2*E₀/(1 - ν₀^2) + (1/32)*(1 + ξ)^2*E₀*(1 - ν₀)/(1 - ν₀^2)
        K[5,6]=(-1/16)*(1 + ξ)*(1 - η)*E₀*ν₀/(1 - ν₀^2) + (-1/32)*(1 + ξ)*(1 - η)*E₀*(1 - ν₀)/(1 - ν₀^2)
        K[5,7]=(1/16)*(1 - η)*(1 + η)*E₀/(1 - ν₀^2) + (-1/32)*(1 + ξ)^2*E₀*(1 - ν₀)/(1 - ν₀^2)
        K[5,8]=(1/16)*(1 + ξ)*(1 - η)*E₀*ν₀/(1 - ν₀^2) + (-1/32)*(1 + ξ)*(1 + η)*E₀*(1 - ν₀)/(1 - ν₀^2)
        K[6,1]=(-1/32)*(1 - ξ)*(1 - η)*E₀*(1 - ν₀)/(1 - ν₀^2) + (1/16)*(1 + ξ)*(1 - η)*E₀*ν₀/(1 - ν₀^2)
        K[6,2]=(-1/32)*(1 - η)^2*E₀*(1 - ν₀)/(1 - ν₀^2) + (1/16)*(1 - ξ)*(1 + ξ)*E₀/(1 - ν₀^2)
        K[6,3]=(1/32)*(1 - ξ)*(1 - η)*E₀*(1 - ν₀)/(1 - ν₀^2) + (1/16)*(1 + ξ)*(1 + η)*E₀*ν₀/(1 - ν₀^2)
        K[6,4]=(-1/16)*(1 - ξ)*(1 + ξ)*E₀/(1 - ν₀^2) + (-1/32)*(1 - η)*(1 + η)*E₀*(1 - ν₀)/(1 - ν₀^2)
        K[6,5]=(-1/16)*(1 + ξ)*(1 - η)*E₀*ν₀/(1 - ν₀^2) + (-1/32)*(1 + ξ)*(1 - η)*E₀*(1 - ν₀)/(1 - ν₀^2)
        K[6,6]=(1/16)*(1 + ξ)^2*E₀/(1 - ν₀^2) + (1/32)*(1 - η)^2*E₀*(1 - ν₀)/(1 - ν₀^2)
        K[6,7]=(1/32)*(1 + ξ)*(1 - η)*E₀*(1 - ν₀)/(1 - ν₀^2) + (-1/16)*(1 + ξ)*(1 + η)*E₀*ν₀/(1 - ν₀^2)
        K[6,8]=(-1/16)*(1 + ξ)^2*E₀/(1 - ν₀^2) + (1/32)*(1 - η)*(1 + η)*E₀*(1 - ν₀)/(1 - ν₀^2)
        K[7,1]=(-1/16)*(1 - η)*(1 + η)*E₀/(1 - ν₀^2) + (-1/32)*(1 - ξ)*(1 + ξ)*E₀*(1 - ν₀)/(1 - ν₀^2)
        K[7,2]=(-1/16)*(1 - ξ)*(1 + η)*E₀*ν₀/(1 - ν₀^2) + (-1/32)*(1 + ξ)*(1 - η)*E₀*(1 - ν₀)/(1 - ν₀^2)
        K[7,3]=(-1/16)*(1 + η)^2*E₀/(1 - ν₀^2) + (1/32)*(1 - ξ)*(1 + ξ)*E₀*(1 - ν₀)/(1 - ν₀^2)
        K[7,4]=(1/16)*(1 - ξ)*(1 + η)*E₀*ν₀/(1 - ν₀^2) + (-1/32)*(1 + ξ)*(1 + η)*E₀*(1 - ν₀)/(1 - ν₀^2)
        K[7,5]=(1/16)*(1 - η)*(1 + η)*E₀/(1 - ν₀^2) + (-1/32)*(1 + ξ)^2*E₀*(1 - ν₀)/(1 - ν₀^2)
        K[7,6]=(1/32)*(1 + ξ)*(1 - η)*E₀*(1 - ν₀)/(1 - ν₀^2) + (-1/16)*(1 + ξ)*(1 + η)*E₀*ν₀/(1 - ν₀^2)
        K[7,7]=(1/16)*(1 + η)^2*E₀/(1 - ν₀^2) + (1/32)*(1 + ξ)^2*E₀*(1 - ν₀)/(1 - ν₀^2)
        K[7,8]=(1/16)*(1 + ξ)*(1 + η)*E₀*ν₀/(1 - ν₀^2) + (1/32)*(1 + ξ)*(1 + η)*E₀*(1 - ν₀)/(1 - ν₀^2)
        K[8,1]=(-1/32)*(1 - ξ)*(1 + η)*E₀*(1 - ν₀)/(1 - ν₀^2) + (-1/16)*(1 + ξ)*(1 - η)*E₀*ν₀/(1 - ν₀^2)
        K[8,2]=(-1/16)*(1 - ξ)*(1 + ξ)*E₀/(1 - ν₀^2) + (-1/32)*(1 - η)*(1 + η)*E₀*(1 - ν₀)/(1 - ν₀^2)
        K[8,3]=(1/32)*(1 - ξ)*(1 + η)*E₀*(1 - ν₀)/(1 - ν₀^2) + (-1/16)*(1 + ξ)*(1 + η)*E₀*ν₀/(1 - ν₀^2)
        K[8,4]=(-1/32)*(1 + η)^2*E₀*(1 - ν₀)/(1 - ν₀^2) + (1/16)*(1 - ξ)*(1 + ξ)*E₀/(1 - ν₀^2)
        K[8,5]=(1/16)*(1 + ξ)*(1 - η)*E₀*ν₀/(1 - ν₀^2) + (-1/32)*(1 + ξ)*(1 + η)*E₀*(1 - ν₀)/(1 - ν₀^2)
        K[8,6]=(-1/16)*(1 + ξ)^2*E₀/(1 - ν₀^2) + (1/32)*(1 - η)*(1 + η)*E₀*(1 - ν₀)/(1 - ν₀^2)
        K[8,7]=(1/16)*(1 + ξ)*(1 + η)*E₀*ν₀/(1 - ν₀^2) + (1/32)*(1 + ξ)*(1 + η)*E₀*(1 - ν₀)/(1 - ν₀^2)
        K[8,8]=(1/16)*(1 + ξ)^2*E₀/(1 - ν₀^2) + (1/32)*(1 + η)^2*E₀*(1 - ν₀)/(1 - ν₀^2)

        J[1,1]=(-1/4)*(1 - η)*x₁ + (1/4)*(1 - η)*x₃ + (-1/4)*(1 + η)*x₂ + (1/4)*(1 + η)*x₄
        J[1,2]=(-1/4)*(1 - η)*y₂ + (1/4)*(1 - η)*y₃ + (-1/4)*(1 + η)*y₂ + (1/4)*(1 + η)*y₄
        J[2,1]=(-1/4)*(1 - ξ)*x₁ + (1/4)*(1 - ξ)*x₂ + (-1/4)*(1 + ξ)*x₃ + (1/4)*(1 + ξ)*x₄
        J[2,2]=(-1/4)*(1 + ξ)*y₃ + (1/4)*(1 + ξ)*y₄

        return K*det(J)*t
    end
    elm.Kmᵉ=sparse(hcubature(BtDB,[-1,1],[1,1])[1])
end

function integrateKb!(elm)
    E₀,ν₀=elm.material.E,elm.material.ν
    center=elm.center
    t=elm.t
    T=elm.T[1:3,1:3]
    x₁,y₁,z₁=T*(elm.node1.loc-center)
    x₂,y₂,z₂=T*(elm.node2.loc-center)
    x₃,y₃,z₃=T*(elm.node3.loc-center)
    x₄,y₄,z₄=T*(elm.node4.loc-center)
    K=Matrix{Float64}(undef,12,12)
    J=Matrix{Float64}(undef,2,2)
    function BtDB(x)
        ξ,η=x[1],x[2]
        # include(joinpath(dirname(@__FILE__),"k_slab.jl"))
        # include(joinpath(dirname(@__FILE__),"jacobi.jl"))

        K[1,1]=-(0.0 + 0.25*(1 - 2*ξ)*(1 + η) - 0.25*(1 + ξ)*(1 + η))*((-1/12)*t^3*E₀*(0.0 + 0.25*(1 - 2*ξ)*(1 + η) - 0.25*(1 + ξ)*(1 + η))/(1 - ν₀^2) + (-1/12)*t^3*E₀*ν₀*(0.0 + 0.25*(1 + ξ)*(1 - 2*η) - 0.25*(1 + ξ)*(1 + η))/(1 - ν₀^2)) - (0.0 + 0.25*(1 + ξ)*(1 - 2*η) - 0.25*(1 + ξ)*(1 + η))*((-1/12)*t^3*E₀*(0.0 + 0.25*(1 + ξ)*(1 - 2*η) - 0.25*(1 + ξ)*(1 + η))/(1 - ν₀^2) + (-1/12)*t^3*E₀*ν₀*(0.0 + 0.25*(1 - 2*ξ)*(1 + η) - 0.25*(1 + ξ)*(1 + η))/(1 - ν₀^2)) + (1/6)*t^3*E₀*(1 - ν₀)*(0.0 + 0.125*(1 - 2*η)*(1 + η) + 0.125*(1 - 2*ξ)*(1 + ξ) + 0.125*(2 + η + ξ - η^2 - ξ^2))^2/(1 - ν₀^2)
        K[1,2]=-((-1/12)*t^3*E₀*(0.0 + 0.25*(1 + ξ)*(1 - 2*η) - 0.25*(1 + ξ)*(1 + η))/(1 - ν₀^2) + (-1/12)*t^3*E₀*ν₀*(0.0 + 0.25*(1 - 2*ξ)*(1 + η) - 0.25*(1 + ξ)*(1 + η))/(1 - ν₀^2))*(0.0 + 0.75*(1 + η)*(-1 + η) + 0.75*(1 + η)^2)
        K[1,3]=-((-1/12)*t^3*E₀*(0.0 + 0.25*(1 - 2*ξ)*(1 + η) - 0.25*(1 + ξ)*(1 + η))/(1 - ν₀^2) + (-1/12)*t^3*E₀*ν₀*(0.0 + 0.25*(1 + ξ)*(1 - 2*η) - 0.25*(1 + ξ)*(1 + η))/(1 - ν₀^2))*(0.0 - 0.75*(-1 + ξ)*(1 + ξ) - 0.75*(1 + ξ)^2)
        K[1,4]=-(0.0 + 0.25*(1 - ξ)*(1 - 2*η) - 0.25*(1 - ξ)*(1 + η))*((-1/12)*t^3*E₀*(0.0 + 0.25*(1 + ξ)*(1 - 2*η) - 0.25*(1 + ξ)*(1 + η))/(1 - ν₀^2) + (-1/12)*t^3*E₀*ν₀*(0.0 + 0.25*(1 - 2*ξ)*(1 + η) - 0.25*(1 + ξ)*(1 + η))/(1 - ν₀^2)) - (0.0 - 0.25*(-1 - 2*ξ)*(1 + η) - 0.25*(1 - ξ)*(1 + η))*((-1/12)*t^3*E₀*(0.0 + 0.25*(1 - 2*ξ)*(1 + η) - 0.25*(1 + ξ)*(1 + η))/(1 - ν₀^2) + (-1/12)*t^3*E₀*ν₀*(0.0 + 0.25*(1 + ξ)*(1 - 2*η) - 0.25*(1 + ξ)*(1 + η))/(1 - ν₀^2)) + (1/6)*t^3*E₀*(1 - ν₀)*(0.0 + 0.125*(1 - 2*η)*(1 + η) + 0.125*(1 - 2*ξ)*(1 + ξ) + 0.125*(2 + η + ξ - η^2 - ξ^2))*(0.0 - 0.125*(1 - 2*η)*(1 + η) + 0.125*(1 - ξ)*(-1 - 2*ξ) - 0.125*(2 + η - ξ - η^2 - ξ^2))/(1 - ν₀^2)
        K[1,5]=-((-1/12)*t^3*E₀*(0.0 + 0.25*(1 + ξ)*(1 - 2*η) - 0.25*(1 + ξ)*(1 + η))/(1 - ν₀^2) + (-1/12)*t^3*E₀*ν₀*(0.0 + 0.25*(1 - 2*ξ)*(1 + η) - 0.25*(1 + ξ)*(1 + η))/(1 - ν₀^2))*(0.0 + 0.75*(1 + η)*(-1 + η) + 0.75*(1 + η)^2)
        K[1,6]=-((-1/12)*t^3*E₀*(0.0 + 0.25*(1 - 2*ξ)*(1 + η) - 0.25*(1 + ξ)*(1 + η))/(1 - ν₀^2) + (-1/12)*t^3*E₀*ν₀*(0.0 + 0.25*(1 + ξ)*(1 - 2*η) - 0.25*(1 + ξ)*(1 + η))/(1 - ν₀^2))*(0.0 + 0.75*(1 - ξ)*(-1 - ξ) + 0.75*(1 - ξ)^2)
        K[1,7]=-(0.0 - 0.25*(-1 - 2*ξ)*(1 - η) - 0.25*(1 - ξ)*(1 - η))*((-1/12)*t^3*E₀*(0.0 + 0.25*(1 - 2*ξ)*(1 + η) - 0.25*(1 + ξ)*(1 + η))/(1 - ν₀^2) + (-1/12)*t^3*E₀*ν₀*(0.0 + 0.25*(1 + ξ)*(1 - 2*η) - 0.25*(1 + ξ)*(1 + η))/(1 - ν₀^2)) - (0.0 - 0.25*(1 - ξ)*(-1 - 2*η) - 0.25*(1 - ξ)*(1 - η))*((-1/12)*t^3*E₀*(0.0 + 0.25*(1 + ξ)*(1 - 2*η) - 0.25*(1 + ξ)*(1 + η))/(1 - ν₀^2) + (-1/12)*t^3*E₀*ν₀*(0.0 + 0.25*(1 - 2*ξ)*(1 + η) - 0.25*(1 + ξ)*(1 + η))/(1 - ν₀^2)) + (1/6)*t^3*E₀*(1 - ν₀)*(0.0 - 0.125*(1 - η)*(-1 - 2*η) - 0.125*(1 - ξ)*(-1 - 2*ξ) + 0.125*(2 - η - ξ - η^2 - ξ^2))*(0.0 + 0.125*(1 - 2*η)*(1 + η) + 0.125*(1 - 2*ξ)*(1 + ξ) + 0.125*(2 + η + ξ - η^2 - ξ^2))/(1 - ν₀^2)
        K[1,8]=-((-1/12)*t^3*E₀*(0.0 + 0.25*(1 + ξ)*(1 - 2*η) - 0.25*(1 + ξ)*(1 + η))/(1 - ν₀^2) + (-1/12)*t^3*E₀*ν₀*(0.0 + 0.25*(1 - 2*ξ)*(1 + η) - 0.25*(1 + ξ)*(1 + η))/(1 - ν₀^2))*(0.0 - 0.75*(1 - η)*(-1 - η) - 0.75*(1 - η)^2)
        K[1,9]=-((-1/12)*t^3*E₀*(0.0 + 0.25*(1 - 2*ξ)*(1 + η) - 0.25*(1 + ξ)*(1 + η))/(1 - ν₀^2) + (-1/12)*t^3*E₀*ν₀*(0.0 + 0.25*(1 + ξ)*(1 - 2*η) - 0.25*(1 + ξ)*(1 + η))/(1 - ν₀^2))*(0.0 + 0.75*(1 - ξ)*(-1 - ξ) + 0.75*(1 - ξ)^2)
        K[1,10]=-(0.0 - 0.25*(1 + ξ)*(-1 - 2*η) - 0.25*(1 + ξ)*(1 - η))*((-1/12)*t^3*E₀*(0.0 + 0.25*(1 + ξ)*(1 - 2*η) - 0.25*(1 + ξ)*(1 + η))/(1 - ν₀^2) + (-1/12)*t^3*E₀*ν₀*(0.0 + 0.25*(1 - 2*ξ)*(1 + η) - 0.25*(1 + ξ)*(1 + η))/(1 - ν₀^2)) - (0.0 + 0.25*(1 - 2*ξ)*(1 - η) - 0.25*(1 + ξ)*(1 - η))*((-1/12)*t^3*E₀*(0.0 + 0.25*(1 - 2*ξ)*(1 + η) - 0.25*(1 + ξ)*(1 + η))/(1 - ν₀^2) + (-1/12)*t^3*E₀*ν₀*(0.0 + 0.25*(1 + ξ)*(1 - 2*η) - 0.25*(1 + ξ)*(1 + η))/(1 - ν₀^2)) + (1/6)*t^3*E₀*(1 - ν₀)*(0.0 + 0.125*(1 - 2*η)*(1 + η) + 0.125*(1 - 2*ξ)*(1 + ξ) + 0.125*(2 + η + ξ - η^2 - ξ^2))*(0.0 + 0.125*(1 - η)*(-1 - 2*η) - 0.125*(1 - 2*ξ)*(1 + ξ) - 0.125*(2 - η + ξ - η^2 - ξ^2))/(1 - ν₀^2)
        K[1,11]=-((-1/12)*t^3*E₀*(0.0 + 0.25*(1 + ξ)*(1 - 2*η) - 0.25*(1 + ξ)*(1 + η))/(1 - ν₀^2) + (-1/12)*t^3*E₀*ν₀*(0.0 + 0.25*(1 - 2*ξ)*(1 + η) - 0.25*(1 + ξ)*(1 + η))/(1 - ν₀^2))*(0.0 - 0.75*(1 - η)*(-1 - η) - 0.75*(1 - η)^2)
        K[1,12]=-((-1/12)*t^3*E₀*(0.0 + 0.25*(1 - 2*ξ)*(1 + η) - 0.25*(1 + ξ)*(1 + η))/(1 - ν₀^2) + (-1/12)*t^3*E₀*ν₀*(0.0 + 0.25*(1 + ξ)*(1 - 2*η) - 0.25*(1 + ξ)*(1 + η))/(1 - ν₀^2))*(0.0 - 0.75*(-1 + ξ)*(1 + ξ) - 0.75*(1 + ξ)^2)
        K[2,1]=(1/12)*t^3*E₀*(0.0 + 0.25*(1 + ξ)*(1 - 2*η) - 0.25*(1 + ξ)*(1 + η))*(0.0 + 0.75*(1 + η)*(-1 + η) + 0.75*(1 + η)^2)/(1 - ν₀^2) + (1/12)*t^3*E₀*ν₀*(0.0 + 0.25*(1 - 2*ξ)*(1 + η) - 0.25*(1 + ξ)*(1 + η))*(0.0 + 0.75*(1 + η)*(-1 + η) + 0.75*(1 + η)^2)/(1 - ν₀^2)
        K[2,2]=(1/12)*t^3*E₀*(0.0 + 0.75*(1 + η)*(-1 + η) + 0.75*(1 + η)^2)^2/(1 - ν₀^2)
        K[2,3]=(1/12)*t^3*E₀*ν₀*(0.0 + 0.75*(1 + η)*(-1 + η) + 0.75*(1 + η)^2)*(0.0 - 0.75*(-1 + ξ)*(1 + ξ) - 0.75*(1 + ξ)^2)/(1 - ν₀^2)
        K[2,4]=(1/12)*t^3*E₀*(0.0 + 0.25*(1 - ξ)*(1 - 2*η) - 0.25*(1 - ξ)*(1 + η))*(0.0 + 0.75*(1 + η)*(-1 + η) + 0.75*(1 + η)^2)/(1 - ν₀^2) + (1/12)*t^3*(0.0 - 0.25*(-1 - 2*ξ)*(1 + η) - 0.25*(1 - ξ)*(1 + η))*E₀*ν₀*(0.0 + 0.75*(1 + η)*(-1 + η) + 0.75*(1 + η)^2)/(1 - ν₀^2)
        K[2,5]=(1/12)*t^3*E₀*(0.0 + 0.75*(1 + η)*(-1 + η) + 0.75*(1 + η)^2)^2/(1 - ν₀^2)
        K[2,6]=(1/12)*t^3*E₀*ν₀*(0.0 + 0.75*(1 - ξ)*(-1 - ξ) + 0.75*(1 - ξ)^2)*(0.0 + 0.75*(1 + η)*(-1 + η) + 0.75*(1 + η)^2)/(1 - ν₀^2)
        K[2,7]=(1/12)*t^3*(0.0 - 0.25*(1 - ξ)*(-1 - 2*η) - 0.25*(1 - ξ)*(1 - η))*E₀*(0.0 + 0.75*(1 + η)*(-1 + η) + 0.75*(1 + η)^2)/(1 - ν₀^2) + (1/12)*t^3*(0.0 - 0.25*(-1 - 2*ξ)*(1 - η) - 0.25*(1 - ξ)*(1 - η))*E₀*ν₀*(0.0 + 0.75*(1 + η)*(-1 + η) + 0.75*(1 + η)^2)/(1 - ν₀^2)
        K[2,8]=(1/12)*t^3*E₀*(0.0 - 0.75*(1 - η)*(-1 - η) - 0.75*(1 - η)^2)*(0.0 + 0.75*(1 + η)*(-1 + η) + 0.75*(1 + η)^2)/(1 - ν₀^2)
        K[2,9]=(1/12)*t^3*E₀*ν₀*(0.0 + 0.75*(1 - ξ)*(-1 - ξ) + 0.75*(1 - ξ)^2)*(0.0 + 0.75*(1 + η)*(-1 + η) + 0.75*(1 + η)^2)/(1 - ν₀^2)
        K[2,10]=(1/12)*t^3*(0.0 - 0.25*(1 + ξ)*(-1 - 2*η) - 0.25*(1 + ξ)*(1 - η))*E₀*(0.0 + 0.75*(1 + η)*(-1 + η) + 0.75*(1 + η)^2)/(1 - ν₀^2) + (1/12)*t^3*E₀*ν₀*(0.0 + 0.25*(1 - 2*ξ)*(1 - η) - 0.25*(1 + ξ)*(1 - η))*(0.0 + 0.75*(1 + η)*(-1 + η) + 0.75*(1 + η)^2)/(1 - ν₀^2)
        K[2,11]=(1/12)*t^3*E₀*(0.0 - 0.75*(1 - η)*(-1 - η) - 0.75*(1 - η)^2)*(0.0 + 0.75*(1 + η)*(-1 + η) + 0.75*(1 + η)^2)/(1 - ν₀^2)
        K[2,12]=(1/12)*t^3*E₀*ν₀*(0.0 + 0.75*(1 + η)*(-1 + η) + 0.75*(1 + η)^2)*(0.0 - 0.75*(-1 + ξ)*(1 + ξ) - 0.75*(1 + ξ)^2)/(1 - ν₀^2)
        K[3,1]=(1/12)*t^3*E₀*(0.0 + 0.25*(1 - 2*ξ)*(1 + η) - 0.25*(1 + ξ)*(1 + η))*(0.0 - 0.75*(-1 + ξ)*(1 + ξ) - 0.75*(1 + ξ)^2)/(1 - ν₀^2) + (1/12)*t^3*E₀*ν₀*(0.0 + 0.25*(1 + ξ)*(1 - 2*η) - 0.25*(1 + ξ)*(1 + η))*(0.0 - 0.75*(-1 + ξ)*(1 + ξ) - 0.75*(1 + ξ)^2)/(1 - ν₀^2)
        K[3,2]=(1/12)*t^3*E₀*ν₀*(0.0 + 0.75*(1 + η)*(-1 + η) + 0.75*(1 + η)^2)*(0.0 - 0.75*(-1 + ξ)*(1 + ξ) - 0.75*(1 + ξ)^2)/(1 - ν₀^2)
        K[3,3]=(1/12)*t^3*E₀*(0.0 - 0.75*(-1 + ξ)*(1 + ξ) - 0.75*(1 + ξ)^2)^2/(1 - ν₀^2)
        K[3,4]=(1/12)*t^3*(0.0 - 0.25*(-1 - 2*ξ)*(1 + η) - 0.25*(1 - ξ)*(1 + η))*E₀*(0.0 - 0.75*(-1 + ξ)*(1 + ξ) - 0.75*(1 + ξ)^2)/(1 - ν₀^2) + (1/12)*t^3*E₀*ν₀*(0.0 + 0.25*(1 - ξ)*(1 - 2*η) - 0.25*(1 - ξ)*(1 + η))*(0.0 - 0.75*(-1 + ξ)*(1 + ξ) - 0.75*(1 + ξ)^2)/(1 - ν₀^2)
        K[3,5]=(1/12)*t^3*E₀*ν₀*(0.0 + 0.75*(1 + η)*(-1 + η) + 0.75*(1 + η)^2)*(0.0 - 0.75*(-1 + ξ)*(1 + ξ) - 0.75*(1 + ξ)^2)/(1 - ν₀^2)
        K[3,6]=(1/12)*t^3*E₀*(0.0 + 0.75*(1 - ξ)*(-1 - ξ) + 0.75*(1 - ξ)^2)*(0.0 - 0.75*(-1 + ξ)*(1 + ξ) - 0.75*(1 + ξ)^2)/(1 - ν₀^2)
        K[3,7]=(1/12)*t^3*(0.0 - 0.25*(-1 - 2*ξ)*(1 - η) - 0.25*(1 - ξ)*(1 - η))*E₀*(0.0 - 0.75*(-1 + ξ)*(1 + ξ) - 0.75*(1 + ξ)^2)/(1 - ν₀^2) + (1/12)*t^3*(0.0 - 0.25*(1 - ξ)*(-1 - 2*η) - 0.25*(1 - ξ)*(1 - η))*E₀*ν₀*(0.0 - 0.75*(-1 + ξ)*(1 + ξ) - 0.75*(1 + ξ)^2)/(1 - ν₀^2)
        K[3,8]=(1/12)*t^3*E₀*ν₀*(0.0 - 0.75*(1 - η)*(-1 - η) - 0.75*(1 - η)^2)*(0.0 - 0.75*(-1 + ξ)*(1 + ξ) - 0.75*(1 + ξ)^2)/(1 - ν₀^2)
        K[3,9]=(1/12)*t^3*E₀*(0.0 + 0.75*(1 - ξ)*(-1 - ξ) + 0.75*(1 - ξ)^2)*(0.0 - 0.75*(-1 + ξ)*(1 + ξ) - 0.75*(1 + ξ)^2)/(1 - ν₀^2)
        K[3,10]=(1/12)*t^3*E₀*(0.0 + 0.25*(1 - 2*ξ)*(1 - η) - 0.25*(1 + ξ)*(1 - η))*(0.0 - 0.75*(-1 + ξ)*(1 + ξ) - 0.75*(1 + ξ)^2)/(1 - ν₀^2) + (1/12)*t^3*(0.0 - 0.25*(1 + ξ)*(-1 - 2*η) - 0.25*(1 + ξ)*(1 - η))*E₀*ν₀*(0.0 - 0.75*(-1 + ξ)*(1 + ξ) - 0.75*(1 + ξ)^2)/(1 - ν₀^2)
        K[3,11]=(1/12)*t^3*E₀*ν₀*(0.0 - 0.75*(1 - η)*(-1 - η) - 0.75*(1 - η)^2)*(0.0 - 0.75*(-1 + ξ)*(1 + ξ) - 0.75*(1 + ξ)^2)/(1 - ν₀^2)
        K[3,12]=(1/12)*t^3*E₀*(0.0 - 0.75*(-1 + ξ)*(1 + ξ) - 0.75*(1 + ξ)^2)^2/(1 - ν₀^2)
        K[4,1]=-((-1/12)*t^3*E₀*(0.0 + 0.25*(1 - ξ)*(1 - 2*η) - 0.25*(1 - ξ)*(1 + η))/(1 - ν₀^2) + (-1/12)*t^3*(0.0 - 0.25*(-1 - 2*ξ)*(1 + η) - 0.25*(1 - ξ)*(1 + η))*E₀*ν₀/(1 - ν₀^2))*(0.0 + 0.25*(1 + ξ)*(1 - 2*η) - 0.25*(1 + ξ)*(1 + η)) - (0.0 + 0.25*(1 - 2*ξ)*(1 + η) - 0.25*(1 + ξ)*(1 + η))*((-1/12)*t^3*(0.0 - 0.25*(-1 - 2*ξ)*(1 + η) - 0.25*(1 - ξ)*(1 + η))*E₀/(1 - ν₀^2) + (-1/12)*t^3*E₀*ν₀*(0.0 + 0.25*(1 - ξ)*(1 - 2*η) - 0.25*(1 - ξ)*(1 + η))/(1 - ν₀^2)) + (1/6)*t^3*E₀*(1 - ν₀)*(0.0 + 0.125*(1 - 2*η)*(1 + η) + 0.125*(1 - 2*ξ)*(1 + ξ) + 0.125*(2 + η + ξ - η^2 - ξ^2))*(0.0 - 0.125*(1 - 2*η)*(1 + η) + 0.125*(1 - ξ)*(-1 - 2*ξ) - 0.125*(2 + η - ξ - η^2 - ξ^2))/(1 - ν₀^2)
        K[4,2]=-((-1/12)*t^3*E₀*(0.0 + 0.25*(1 - ξ)*(1 - 2*η) - 0.25*(1 - ξ)*(1 + η))/(1 - ν₀^2) + (-1/12)*t^3*(0.0 - 0.25*(-1 - 2*ξ)*(1 + η) - 0.25*(1 - ξ)*(1 + η))*E₀*ν₀/(1 - ν₀^2))*(0.0 + 0.75*(1 + η)*(-1 + η) + 0.75*(1 + η)^2)
        K[4,3]=-((-1/12)*t^3*(0.0 - 0.25*(-1 - 2*ξ)*(1 + η) - 0.25*(1 - ξ)*(1 + η))*E₀/(1 - ν₀^2) + (-1/12)*t^3*E₀*ν₀*(0.0 + 0.25*(1 - ξ)*(1 - 2*η) - 0.25*(1 - ξ)*(1 + η))/(1 - ν₀^2))*(0.0 - 0.75*(-1 + ξ)*(1 + ξ) - 0.75*(1 + ξ)^2)
        K[4,4]=-((-1/12)*t^3*E₀*(0.0 + 0.25*(1 - ξ)*(1 - 2*η) - 0.25*(1 - ξ)*(1 + η))/(1 - ν₀^2) + (-1/12)*t^3*(0.0 - 0.25*(-1 - 2*ξ)*(1 + η) - 0.25*(1 - ξ)*(1 + η))*E₀*ν₀/(1 - ν₀^2))*(0.0 + 0.25*(1 - ξ)*(1 - 2*η) - 0.25*(1 - ξ)*(1 + η)) - (0.0 - 0.25*(-1 - 2*ξ)*(1 + η) - 0.25*(1 - ξ)*(1 + η))*((-1/12)*t^3*(0.0 - 0.25*(-1 - 2*ξ)*(1 + η) - 0.25*(1 - ξ)*(1 + η))*E₀/(1 - ν₀^2) + (-1/12)*t^3*E₀*ν₀*(0.0 + 0.25*(1 - ξ)*(1 - 2*η) - 0.25*(1 - ξ)*(1 + η))/(1 - ν₀^2)) + (1/6)*t^3*E₀*(1 - ν₀)*(0.0 - 0.125*(1 - 2*η)*(1 + η) + 0.125*(1 - ξ)*(-1 - 2*ξ) - 0.125*(2 + η - ξ - η^2 - ξ^2))^2/(1 - ν₀^2)
        K[4,5]=-((-1/12)*t^3*E₀*(0.0 + 0.25*(1 - ξ)*(1 - 2*η) - 0.25*(1 - ξ)*(1 + η))/(1 - ν₀^2) + (-1/12)*t^3*(0.0 - 0.25*(-1 - 2*ξ)*(1 + η) - 0.25*(1 - ξ)*(1 + η))*E₀*ν₀/(1 - ν₀^2))*(0.0 + 0.75*(1 + η)*(-1 + η) + 0.75*(1 + η)^2)
        K[4,6]=-((-1/12)*t^3*(0.0 - 0.25*(-1 - 2*ξ)*(1 + η) - 0.25*(1 - ξ)*(1 + η))*E₀/(1 - ν₀^2) + (-1/12)*t^3*E₀*ν₀*(0.0 + 0.25*(1 - ξ)*(1 - 2*η) - 0.25*(1 - ξ)*(1 + η))/(1 - ν₀^2))*(0.0 + 0.75*(1 - ξ)*(-1 - ξ) + 0.75*(1 - ξ)^2)
        K[4,7]=-(0.0 - 0.25*(-1 - 2*ξ)*(1 - η) - 0.25*(1 - ξ)*(1 - η))*((-1/12)*t^3*(0.0 - 0.25*(-1 - 2*ξ)*(1 + η) - 0.25*(1 - ξ)*(1 + η))*E₀/(1 - ν₀^2) + (-1/12)*t^3*E₀*ν₀*(0.0 + 0.25*(1 - ξ)*(1 - 2*η) - 0.25*(1 - ξ)*(1 + η))/(1 - ν₀^2)) - (0.0 - 0.25*(1 - ξ)*(-1 - 2*η) - 0.25*(1 - ξ)*(1 - η))*((-1/12)*t^3*E₀*(0.0 + 0.25*(1 - ξ)*(1 - 2*η) - 0.25*(1 - ξ)*(1 + η))/(1 - ν₀^2) + (-1/12)*t^3*(0.0 - 0.25*(-1 - 2*ξ)*(1 + η) - 0.25*(1 - ξ)*(1 + η))*E₀*ν₀/(1 - ν₀^2)) + (1/6)*t^3*E₀*(1 - ν₀)*(0.0 - 0.125*(1 - η)*(-1 - 2*η) - 0.125*(1 - ξ)*(-1 - 2*ξ) + 0.125*(2 - η - ξ - η^2 - ξ^2))*(0.0 - 0.125*(1 - 2*η)*(1 + η) + 0.125*(1 - ξ)*(-1 - 2*ξ) - 0.125*(2 + η - ξ - η^2 - ξ^2))/(1 - ν₀^2)
        K[4,8]=-((-1/12)*t^3*E₀*(0.0 + 0.25*(1 - ξ)*(1 - 2*η) - 0.25*(1 - ξ)*(1 + η))/(1 - ν₀^2) + (-1/12)*t^3*(0.0 - 0.25*(-1 - 2*ξ)*(1 + η) - 0.25*(1 - ξ)*(1 + η))*E₀*ν₀/(1 - ν₀^2))*(0.0 - 0.75*(1 - η)*(-1 - η) - 0.75*(1 - η)^2)
        K[4,9]=-((-1/12)*t^3*(0.0 - 0.25*(-1 - 2*ξ)*(1 + η) - 0.25*(1 - ξ)*(1 + η))*E₀/(1 - ν₀^2) + (-1/12)*t^3*E₀*ν₀*(0.0 + 0.25*(1 - ξ)*(1 - 2*η) - 0.25*(1 - ξ)*(1 + η))/(1 - ν₀^2))*(0.0 + 0.75*(1 - ξ)*(-1 - ξ) + 0.75*(1 - ξ)^2)
        K[4,10]=-(0.0 - 0.25*(1 + ξ)*(-1 - 2*η) - 0.25*(1 + ξ)*(1 - η))*((-1/12)*t^3*E₀*(0.0 + 0.25*(1 - ξ)*(1 - 2*η) - 0.25*(1 - ξ)*(1 + η))/(1 - ν₀^2) + (-1/12)*t^3*(0.0 - 0.25*(-1 - 2*ξ)*(1 + η) - 0.25*(1 - ξ)*(1 + η))*E₀*ν₀/(1 - ν₀^2)) - (0.0 + 0.25*(1 - 2*ξ)*(1 - η) - 0.25*(1 + ξ)*(1 - η))*((-1/12)*t^3*(0.0 - 0.25*(-1 - 2*ξ)*(1 + η) - 0.25*(1 - ξ)*(1 + η))*E₀/(1 - ν₀^2) + (-1/12)*t^3*E₀*ν₀*(0.0 + 0.25*(1 - ξ)*(1 - 2*η) - 0.25*(1 - ξ)*(1 + η))/(1 - ν₀^2)) + (1/6)*t^3*E₀*(1 - ν₀)*(0.0 + 0.125*(1 - η)*(-1 - 2*η) - 0.125*(1 - 2*ξ)*(1 + ξ) - 0.125*(2 - η + ξ - η^2 - ξ^2))*(0.0 - 0.125*(1 - 2*η)*(1 + η) + 0.125*(1 - ξ)*(-1 - 2*ξ) - 0.125*(2 + η - ξ - η^2 - ξ^2))/(1 - ν₀^2)
        K[4,11]=-((-1/12)*t^3*E₀*(0.0 + 0.25*(1 - ξ)*(1 - 2*η) - 0.25*(1 - ξ)*(1 + η))/(1 - ν₀^2) + (-1/12)*t^3*(0.0 - 0.25*(-1 - 2*ξ)*(1 + η) - 0.25*(1 - ξ)*(1 + η))*E₀*ν₀/(1 - ν₀^2))*(0.0 - 0.75*(1 - η)*(-1 - η) - 0.75*(1 - η)^2)
        K[4,12]=-((-1/12)*t^3*(0.0 - 0.25*(-1 - 2*ξ)*(1 + η) - 0.25*(1 - ξ)*(1 + η))*E₀/(1 - ν₀^2) + (-1/12)*t^3*E₀*ν₀*(0.0 + 0.25*(1 - ξ)*(1 - 2*η) - 0.25*(1 - ξ)*(1 + η))/(1 - ν₀^2))*(0.0 - 0.75*(-1 + ξ)*(1 + ξ) - 0.75*(1 + ξ)^2)
        K[5,1]=(1/12)*t^3*E₀*(0.0 + 0.25*(1 + ξ)*(1 - 2*η) - 0.25*(1 + ξ)*(1 + η))*(0.0 + 0.75*(1 + η)*(-1 + η) + 0.75*(1 + η)^2)/(1 - ν₀^2) + (1/12)*t^3*E₀*ν₀*(0.0 + 0.25*(1 - 2*ξ)*(1 + η) - 0.25*(1 + ξ)*(1 + η))*(0.0 + 0.75*(1 + η)*(-1 + η) + 0.75*(1 + η)^2)/(1 - ν₀^2)
        K[5,2]=(1/12)*t^3*E₀*(0.0 + 0.75*(1 + η)*(-1 + η) + 0.75*(1 + η)^2)^2/(1 - ν₀^2)
        K[5,3]=(1/12)*t^3*E₀*ν₀*(0.0 + 0.75*(1 + η)*(-1 + η) + 0.75*(1 + η)^2)*(0.0 - 0.75*(-1 + ξ)*(1 + ξ) - 0.75*(1 + ξ)^2)/(1 - ν₀^2)
        K[5,4]=(1/12)*t^3*E₀*(0.0 + 0.25*(1 - ξ)*(1 - 2*η) - 0.25*(1 - ξ)*(1 + η))*(0.0 + 0.75*(1 + η)*(-1 + η) + 0.75*(1 + η)^2)/(1 - ν₀^2) + (1/12)*t^3*(0.0 - 0.25*(-1 - 2*ξ)*(1 + η) - 0.25*(1 - ξ)*(1 + η))*E₀*ν₀*(0.0 + 0.75*(1 + η)*(-1 + η) + 0.75*(1 + η)^2)/(1 - ν₀^2)
        K[5,5]=(1/12)*t^3*E₀*(0.0 + 0.75*(1 + η)*(-1 + η) + 0.75*(1 + η)^2)^2/(1 - ν₀^2)
        K[5,6]=(1/12)*t^3*E₀*ν₀*(0.0 + 0.75*(1 - ξ)*(-1 - ξ) + 0.75*(1 - ξ)^2)*(0.0 + 0.75*(1 + η)*(-1 + η) + 0.75*(1 + η)^2)/(1 - ν₀^2)
        K[5,7]=(1/12)*t^3*(0.0 - 0.25*(1 - ξ)*(-1 - 2*η) - 0.25*(1 - ξ)*(1 - η))*E₀*(0.0 + 0.75*(1 + η)*(-1 + η) + 0.75*(1 + η)^2)/(1 - ν₀^2) + (1/12)*t^3*(0.0 - 0.25*(-1 - 2*ξ)*(1 - η) - 0.25*(1 - ξ)*(1 - η))*E₀*ν₀*(0.0 + 0.75*(1 + η)*(-1 + η) + 0.75*(1 + η)^2)/(1 - ν₀^2)
        K[5,8]=(1/12)*t^3*E₀*(0.0 - 0.75*(1 - η)*(-1 - η) - 0.75*(1 - η)^2)*(0.0 + 0.75*(1 + η)*(-1 + η) + 0.75*(1 + η)^2)/(1 - ν₀^2)
        K[5,9]=(1/12)*t^3*E₀*ν₀*(0.0 + 0.75*(1 - ξ)*(-1 - ξ) + 0.75*(1 - ξ)^2)*(0.0 + 0.75*(1 + η)*(-1 + η) + 0.75*(1 + η)^2)/(1 - ν₀^2)
        K[5,10]=(1/12)*t^3*(0.0 - 0.25*(1 + ξ)*(-1 - 2*η) - 0.25*(1 + ξ)*(1 - η))*E₀*(0.0 + 0.75*(1 + η)*(-1 + η) + 0.75*(1 + η)^2)/(1 - ν₀^2) + (1/12)*t^3*E₀*ν₀*(0.0 + 0.25*(1 - 2*ξ)*(1 - η) - 0.25*(1 + ξ)*(1 - η))*(0.0 + 0.75*(1 + η)*(-1 + η) + 0.75*(1 + η)^2)/(1 - ν₀^2)
        K[5,11]=(1/12)*t^3*E₀*(0.0 - 0.75*(1 - η)*(-1 - η) - 0.75*(1 - η)^2)*(0.0 + 0.75*(1 + η)*(-1 + η) + 0.75*(1 + η)^2)/(1 - ν₀^2)
        K[5,12]=(1/12)*t^3*E₀*ν₀*(0.0 + 0.75*(1 + η)*(-1 + η) + 0.75*(1 + η)^2)*(0.0 - 0.75*(-1 + ξ)*(1 + ξ) - 0.75*(1 + ξ)^2)/(1 - ν₀^2)
        K[6,1]=(1/12)*t^3*E₀*(0.0 + 0.25*(1 - 2*ξ)*(1 + η) - 0.25*(1 + ξ)*(1 + η))*(0.0 + 0.75*(1 - ξ)*(-1 - ξ) + 0.75*(1 - ξ)^2)/(1 - ν₀^2) + (1/12)*t^3*E₀*ν₀*(0.0 + 0.25*(1 + ξ)*(1 - 2*η) - 0.25*(1 + ξ)*(1 + η))*(0.0 + 0.75*(1 - ξ)*(-1 - ξ) + 0.75*(1 - ξ)^2)/(1 - ν₀^2)
        K[6,2]=(1/12)*t^3*E₀*ν₀*(0.0 + 0.75*(1 - ξ)*(-1 - ξ) + 0.75*(1 - ξ)^2)*(0.0 + 0.75*(1 + η)*(-1 + η) + 0.75*(1 + η)^2)/(1 - ν₀^2)
        K[6,3]=(1/12)*t^3*E₀*(0.0 + 0.75*(1 - ξ)*(-1 - ξ) + 0.75*(1 - ξ)^2)*(0.0 - 0.75*(-1 + ξ)*(1 + ξ) - 0.75*(1 + ξ)^2)/(1 - ν₀^2)
        K[6,4]=(1/12)*t^3*(0.0 - 0.25*(-1 - 2*ξ)*(1 + η) - 0.25*(1 - ξ)*(1 + η))*E₀*(0.0 + 0.75*(1 - ξ)*(-1 - ξ) + 0.75*(1 - ξ)^2)/(1 - ν₀^2) + (1/12)*t^3*E₀*ν₀*(0.0 + 0.25*(1 - ξ)*(1 - 2*η) - 0.25*(1 - ξ)*(1 + η))*(0.0 + 0.75*(1 - ξ)*(-1 - ξ) + 0.75*(1 - ξ)^2)/(1 - ν₀^2)
        K[6,5]=(1/12)*t^3*E₀*ν₀*(0.0 + 0.75*(1 - ξ)*(-1 - ξ) + 0.75*(1 - ξ)^2)*(0.0 + 0.75*(1 + η)*(-1 + η) + 0.75*(1 + η)^2)/(1 - ν₀^2)
        K[6,6]=(1/12)*t^3*E₀*(0.0 + 0.75*(1 - ξ)*(-1 - ξ) + 0.75*(1 - ξ)^2)^2/(1 - ν₀^2)
        K[6,7]=(1/12)*t^3*(0.0 - 0.25*(-1 - 2*ξ)*(1 - η) - 0.25*(1 - ξ)*(1 - η))*E₀*(0.0 + 0.75*(1 - ξ)*(-1 - ξ) + 0.75*(1 - ξ)^2)/(1 - ν₀^2) + (1/12)*t^3*(0.0 - 0.25*(1 - ξ)*(-1 - 2*η) - 0.25*(1 - ξ)*(1 - η))*E₀*ν₀*(0.0 + 0.75*(1 - ξ)*(-1 - ξ) + 0.75*(1 - ξ)^2)/(1 - ν₀^2)
        K[6,8]=(1/12)*t^3*E₀*ν₀*(0.0 + 0.75*(1 - ξ)*(-1 - ξ) + 0.75*(1 - ξ)^2)*(0.0 - 0.75*(1 - η)*(-1 - η) - 0.75*(1 - η)^2)/(1 - ν₀^2)
        K[6,9]=(1/12)*t^3*E₀*(0.0 + 0.75*(1 - ξ)*(-1 - ξ) + 0.75*(1 - ξ)^2)^2/(1 - ν₀^2)
        K[6,10]=(1/12)*t^3*E₀*(0.0 + 0.25*(1 - 2*ξ)*(1 - η) - 0.25*(1 + ξ)*(1 - η))*(0.0 + 0.75*(1 - ξ)*(-1 - ξ) + 0.75*(1 - ξ)^2)/(1 - ν₀^2) + (1/12)*t^3*(0.0 - 0.25*(1 + ξ)*(-1 - 2*η) - 0.25*(1 + ξ)*(1 - η))*E₀*ν₀*(0.0 + 0.75*(1 - ξ)*(-1 - ξ) + 0.75*(1 - ξ)^2)/(1 - ν₀^2)
        K[6,11]=(1/12)*t^3*E₀*ν₀*(0.0 + 0.75*(1 - ξ)*(-1 - ξ) + 0.75*(1 - ξ)^2)*(0.0 - 0.75*(1 - η)*(-1 - η) - 0.75*(1 - η)^2)/(1 - ν₀^2)
        K[6,12]=(1/12)*t^3*E₀*(0.0 + 0.75*(1 - ξ)*(-1 - ξ) + 0.75*(1 - ξ)^2)*(0.0 - 0.75*(-1 + ξ)*(1 + ξ) - 0.75*(1 + ξ)^2)/(1 - ν₀^2)
        K[7,1]=-((-1/12)*t^3*(0.0 - 0.25*(1 - ξ)*(-1 - 2*η) - 0.25*(1 - ξ)*(1 - η))*E₀/(1 - ν₀^2) + (-1/12)*t^3*(0.0 - 0.25*(-1 - 2*ξ)*(1 - η) - 0.25*(1 - ξ)*(1 - η))*E₀*ν₀/(1 - ν₀^2))*(0.0 + 0.25*(1 + ξ)*(1 - 2*η) - 0.25*(1 + ξ)*(1 + η)) - (0.0 + 0.25*(1 - 2*ξ)*(1 + η) - 0.25*(1 + ξ)*(1 + η))*((-1/12)*t^3*(0.0 - 0.25*(-1 - 2*ξ)*(1 - η) - 0.25*(1 - ξ)*(1 - η))*E₀/(1 - ν₀^2) + (-1/12)*t^3*(0.0 - 0.25*(1 - ξ)*(-1 - 2*η) - 0.25*(1 - ξ)*(1 - η))*E₀*ν₀/(1 - ν₀^2)) + (1/6)*t^3*E₀*(1 - ν₀)*(0.0 - 0.125*(1 - η)*(-1 - 2*η) - 0.125*(1 - ξ)*(-1 - 2*ξ) + 0.125*(2 - η - ξ - η^2 - ξ^2))*(0.0 + 0.125*(1 - 2*η)*(1 + η) + 0.125*(1 - 2*ξ)*(1 + ξ) + 0.125*(2 + η + ξ - η^2 - ξ^2))/(1 - ν₀^2)
        K[7,2]=-((-1/12)*t^3*(0.0 - 0.25*(1 - ξ)*(-1 - 2*η) - 0.25*(1 - ξ)*(1 - η))*E₀/(1 - ν₀^2) + (-1/12)*t^3*(0.0 - 0.25*(-1 - 2*ξ)*(1 - η) - 0.25*(1 - ξ)*(1 - η))*E₀*ν₀/(1 - ν₀^2))*(0.0 + 0.75*(1 + η)*(-1 + η) + 0.75*(1 + η)^2)
        K[7,3]=-(0.0 - 0.75*(-1 + ξ)*(1 + ξ) - 0.75*(1 + ξ)^2)*((-1/12)*t^3*(0.0 - 0.25*(-1 - 2*ξ)*(1 - η) - 0.25*(1 - ξ)*(1 - η))*E₀/(1 - ν₀^2) + (-1/12)*t^3*(0.0 - 0.25*(1 - ξ)*(-1 - 2*η) - 0.25*(1 - ξ)*(1 - η))*E₀*ν₀/(1 - ν₀^2))
        K[7,4]=-((-1/12)*t^3*(0.0 - 0.25*(1 - ξ)*(-1 - 2*η) - 0.25*(1 - ξ)*(1 - η))*E₀/(1 - ν₀^2) + (-1/12)*t^3*(0.0 - 0.25*(-1 - 2*ξ)*(1 - η) - 0.25*(1 - ξ)*(1 - η))*E₀*ν₀/(1 - ν₀^2))*(0.0 + 0.25*(1 - ξ)*(1 - 2*η) - 0.25*(1 - ξ)*(1 + η)) - (0.0 - 0.25*(-1 - 2*ξ)*(1 + η) - 0.25*(1 - ξ)*(1 + η))*((-1/12)*t^3*(0.0 - 0.25*(-1 - 2*ξ)*(1 - η) - 0.25*(1 - ξ)*(1 - η))*E₀/(1 - ν₀^2) + (-1/12)*t^3*(0.0 - 0.25*(1 - ξ)*(-1 - 2*η) - 0.25*(1 - ξ)*(1 - η))*E₀*ν₀/(1 - ν₀^2)) + (1/6)*t^3*E₀*(1 - ν₀)*(0.0 - 0.125*(1 - η)*(-1 - 2*η) - 0.125*(1 - ξ)*(-1 - 2*ξ) + 0.125*(2 - η - ξ - η^2 - ξ^2))*(0.0 - 0.125*(1 - 2*η)*(1 + η) + 0.125*(1 - ξ)*(-1 - 2*ξ) - 0.125*(2 + η - ξ - η^2 - ξ^2))/(1 - ν₀^2)
        K[7,5]=-((-1/12)*t^3*(0.0 - 0.25*(1 - ξ)*(-1 - 2*η) - 0.25*(1 - ξ)*(1 - η))*E₀/(1 - ν₀^2) + (-1/12)*t^3*(0.0 - 0.25*(-1 - 2*ξ)*(1 - η) - 0.25*(1 - ξ)*(1 - η))*E₀*ν₀/(1 - ν₀^2))*(0.0 + 0.75*(1 + η)*(-1 + η) + 0.75*(1 + η)^2)
        K[7,6]=-(0.0 + 0.75*(1 - ξ)*(-1 - ξ) + 0.75*(1 - ξ)^2)*((-1/12)*t^3*(0.0 - 0.25*(-1 - 2*ξ)*(1 - η) - 0.25*(1 - ξ)*(1 - η))*E₀/(1 - ν₀^2) + (-1/12)*t^3*(0.0 - 0.25*(1 - ξ)*(-1 - 2*η) - 0.25*(1 - ξ)*(1 - η))*E₀*ν₀/(1 - ν₀^2))
        K[7,7]=-(0.0 - 0.25*(-1 - 2*ξ)*(1 - η) - 0.25*(1 - ξ)*(1 - η))*((-1/12)*t^3*(0.0 - 0.25*(-1 - 2*ξ)*(1 - η) - 0.25*(1 - ξ)*(1 - η))*E₀/(1 - ν₀^2) + (-1/12)*t^3*(0.0 - 0.25*(1 - ξ)*(-1 - 2*η) - 0.25*(1 - ξ)*(1 - η))*E₀*ν₀/(1 - ν₀^2)) - (0.0 - 0.25*(1 - ξ)*(-1 - 2*η) - 0.25*(1 - ξ)*(1 - η))*((-1/12)*t^3*(0.0 - 0.25*(1 - ξ)*(-1 - 2*η) - 0.25*(1 - ξ)*(1 - η))*E₀/(1 - ν₀^2) + (-1/12)*t^3*(0.0 - 0.25*(-1 - 2*ξ)*(1 - η) - 0.25*(1 - ξ)*(1 - η))*E₀*ν₀/(1 - ν₀^2)) + (1/6)*t^3*E₀*(1 - ν₀)*(0.0 - 0.125*(1 - η)*(-1 - 2*η) - 0.125*(1 - ξ)*(-1 - 2*ξ) + 0.125*(2 - η - ξ - η^2 - ξ^2))^2/(1 - ν₀^2)
        K[7,8]=-((-1/12)*t^3*(0.0 - 0.25*(1 - ξ)*(-1 - 2*η) - 0.25*(1 - ξ)*(1 - η))*E₀/(1 - ν₀^2) + (-1/12)*t^3*(0.0 - 0.25*(-1 - 2*ξ)*(1 - η) - 0.25*(1 - ξ)*(1 - η))*E₀*ν₀/(1 - ν₀^2))*(0.0 - 0.75*(1 - η)*(-1 - η) - 0.75*(1 - η)^2)
        K[7,9]=-(0.0 + 0.75*(1 - ξ)*(-1 - ξ) + 0.75*(1 - ξ)^2)*((-1/12)*t^3*(0.0 - 0.25*(-1 - 2*ξ)*(1 - η) - 0.25*(1 - ξ)*(1 - η))*E₀/(1 - ν₀^2) + (-1/12)*t^3*(0.0 - 0.25*(1 - ξ)*(-1 - 2*η) - 0.25*(1 - ξ)*(1 - η))*E₀*ν₀/(1 - ν₀^2))
        K[7,10]=-(0.0 - 0.25*(1 + ξ)*(-1 - 2*η) - 0.25*(1 + ξ)*(1 - η))*((-1/12)*t^3*(0.0 - 0.25*(1 - ξ)*(-1 - 2*η) - 0.25*(1 - ξ)*(1 - η))*E₀/(1 - ν₀^2) + (-1/12)*t^3*(0.0 - 0.25*(-1 - 2*ξ)*(1 - η) - 0.25*(1 - ξ)*(1 - η))*E₀*ν₀/(1 - ν₀^2)) - (0.0 + 0.25*(1 - 2*ξ)*(1 - η) - 0.25*(1 + ξ)*(1 - η))*((-1/12)*t^3*(0.0 - 0.25*(-1 - 2*ξ)*(1 - η) - 0.25*(1 - ξ)*(1 - η))*E₀/(1 - ν₀^2) + (-1/12)*t^3*(0.0 - 0.25*(1 - ξ)*(-1 - 2*η) - 0.25*(1 - ξ)*(1 - η))*E₀*ν₀/(1 - ν₀^2)) + (1/6)*t^3*E₀*(1 - ν₀)*(0.0 - 0.125*(1 - η)*(-1 - 2*η) - 0.125*(1 - ξ)*(-1 - 2*ξ) + 0.125*(2 - η - ξ - η^2 - ξ^2))*(0.0 + 0.125*(1 - η)*(-1 - 2*η) - 0.125*(1 - 2*ξ)*(1 + ξ) - 0.125*(2 - η + ξ - η^2 - ξ^2))/(1 - ν₀^2)
        K[7,11]=-((-1/12)*t^3*(0.0 - 0.25*(1 - ξ)*(-1 - 2*η) - 0.25*(1 - ξ)*(1 - η))*E₀/(1 - ν₀^2) + (-1/12)*t^3*(0.0 - 0.25*(-1 - 2*ξ)*(1 - η) - 0.25*(1 - ξ)*(1 - η))*E₀*ν₀/(1 - ν₀^2))*(0.0 - 0.75*(1 - η)*(-1 - η) - 0.75*(1 - η)^2)
        K[7,12]=-(0.0 - 0.75*(-1 + ξ)*(1 + ξ) - 0.75*(1 + ξ)^2)*((-1/12)*t^3*(0.0 - 0.25*(-1 - 2*ξ)*(1 - η) - 0.25*(1 - ξ)*(1 - η))*E₀/(1 - ν₀^2) + (-1/12)*t^3*(0.0 - 0.25*(1 - ξ)*(-1 - 2*η) - 0.25*(1 - ξ)*(1 - η))*E₀*ν₀/(1 - ν₀^2))
        K[8,1]=(1/12)*t^3*E₀*(0.0 + 0.25*(1 + ξ)*(1 - 2*η) - 0.25*(1 + ξ)*(1 + η))*(0.0 - 0.75*(1 - η)*(-1 - η) - 0.75*(1 - η)^2)/(1 - ν₀^2) + (1/12)*t^3*E₀*ν₀*(0.0 + 0.25*(1 - 2*ξ)*(1 + η) - 0.25*(1 + ξ)*(1 + η))*(0.0 - 0.75*(1 - η)*(-1 - η) - 0.75*(1 - η)^2)/(1 - ν₀^2)
        K[8,2]=(1/12)*t^3*E₀*(0.0 - 0.75*(1 - η)*(-1 - η) - 0.75*(1 - η)^2)*(0.0 + 0.75*(1 + η)*(-1 + η) + 0.75*(1 + η)^2)/(1 - ν₀^2)
        K[8,3]=(1/12)*t^3*E₀*ν₀*(0.0 - 0.75*(1 - η)*(-1 - η) - 0.75*(1 - η)^2)*(0.0 - 0.75*(-1 + ξ)*(1 + ξ) - 0.75*(1 + ξ)^2)/(1 - ν₀^2)
        K[8,4]=(1/12)*t^3*E₀*(0.0 + 0.25*(1 - ξ)*(1 - 2*η) - 0.25*(1 - ξ)*(1 + η))*(0.0 - 0.75*(1 - η)*(-1 - η) - 0.75*(1 - η)^2)/(1 - ν₀^2) + (1/12)*t^3*(0.0 - 0.25*(-1 - 2*ξ)*(1 + η) - 0.25*(1 - ξ)*(1 + η))*E₀*ν₀*(0.0 - 0.75*(1 - η)*(-1 - η) - 0.75*(1 - η)^2)/(1 - ν₀^2)
        K[8,5]=(1/12)*t^3*E₀*(0.0 - 0.75*(1 - η)*(-1 - η) - 0.75*(1 - η)^2)*(0.0 + 0.75*(1 + η)*(-1 + η) + 0.75*(1 + η)^2)/(1 - ν₀^2)
        K[8,6]=(1/12)*t^3*E₀*ν₀*(0.0 + 0.75*(1 - ξ)*(-1 - ξ) + 0.75*(1 - ξ)^2)*(0.0 - 0.75*(1 - η)*(-1 - η) - 0.75*(1 - η)^2)/(1 - ν₀^2)
        K[8,7]=(1/12)*t^3*(0.0 - 0.25*(1 - ξ)*(-1 - 2*η) - 0.25*(1 - ξ)*(1 - η))*E₀*(0.0 - 0.75*(1 - η)*(-1 - η) - 0.75*(1 - η)^2)/(1 - ν₀^2) + (1/12)*t^3*(0.0 - 0.25*(-1 - 2*ξ)*(1 - η) - 0.25*(1 - ξ)*(1 - η))*E₀*ν₀*(0.0 - 0.75*(1 - η)*(-1 - η) - 0.75*(1 - η)^2)/(1 - ν₀^2)
        K[8,8]=(1/12)*t^3*E₀*(0.0 - 0.75*(1 - η)*(-1 - η) - 0.75*(1 - η)^2)^2/(1 - ν₀^2)
        K[8,9]=(1/12)*t^3*E₀*ν₀*(0.0 + 0.75*(1 - ξ)*(-1 - ξ) + 0.75*(1 - ξ)^2)*(0.0 - 0.75*(1 - η)*(-1 - η) - 0.75*(1 - η)^2)/(1 - ν₀^2)
        K[8,10]=(1/12)*t^3*(0.0 - 0.25*(1 + ξ)*(-1 - 2*η) - 0.25*(1 + ξ)*(1 - η))*E₀*(0.0 - 0.75*(1 - η)*(-1 - η) - 0.75*(1 - η)^2)/(1 - ν₀^2) + (1/12)*t^3*E₀*ν₀*(0.0 + 0.25*(1 - 2*ξ)*(1 - η) - 0.25*(1 + ξ)*(1 - η))*(0.0 - 0.75*(1 - η)*(-1 - η) - 0.75*(1 - η)^2)/(1 - ν₀^2)
        K[8,11]=(1/12)*t^3*E₀*(0.0 - 0.75*(1 - η)*(-1 - η) - 0.75*(1 - η)^2)^2/(1 - ν₀^2)
        K[8,12]=(1/12)*t^3*E₀*ν₀*(0.0 - 0.75*(1 - η)*(-1 - η) - 0.75*(1 - η)^2)*(0.0 - 0.75*(-1 + ξ)*(1 + ξ) - 0.75*(1 + ξ)^2)/(1 - ν₀^2)
        K[9,1]=(1/12)*t^3*E₀*(0.0 + 0.25*(1 - 2*ξ)*(1 + η) - 0.25*(1 + ξ)*(1 + η))*(0.0 + 0.75*(1 - ξ)*(-1 - ξ) + 0.75*(1 - ξ)^2)/(1 - ν₀^2) + (1/12)*t^3*E₀*ν₀*(0.0 + 0.25*(1 + ξ)*(1 - 2*η) - 0.25*(1 + ξ)*(1 + η))*(0.0 + 0.75*(1 - ξ)*(-1 - ξ) + 0.75*(1 - ξ)^2)/(1 - ν₀^2)
        K[9,2]=(1/12)*t^3*E₀*ν₀*(0.0 + 0.75*(1 - ξ)*(-1 - ξ) + 0.75*(1 - ξ)^2)*(0.0 + 0.75*(1 + η)*(-1 + η) + 0.75*(1 + η)^2)/(1 - ν₀^2)
        K[9,3]=(1/12)*t^3*E₀*(0.0 + 0.75*(1 - ξ)*(-1 - ξ) + 0.75*(1 - ξ)^2)*(0.0 - 0.75*(-1 + ξ)*(1 + ξ) - 0.75*(1 + ξ)^2)/(1 - ν₀^2)
        K[9,4]=(1/12)*t^3*(0.0 - 0.25*(-1 - 2*ξ)*(1 + η) - 0.25*(1 - ξ)*(1 + η))*E₀*(0.0 + 0.75*(1 - ξ)*(-1 - ξ) + 0.75*(1 - ξ)^2)/(1 - ν₀^2) + (1/12)*t^3*E₀*ν₀*(0.0 + 0.25*(1 - ξ)*(1 - 2*η) - 0.25*(1 - ξ)*(1 + η))*(0.0 + 0.75*(1 - ξ)*(-1 - ξ) + 0.75*(1 - ξ)^2)/(1 - ν₀^2)
        K[9,5]=(1/12)*t^3*E₀*ν₀*(0.0 + 0.75*(1 - ξ)*(-1 - ξ) + 0.75*(1 - ξ)^2)*(0.0 + 0.75*(1 + η)*(-1 + η) + 0.75*(1 + η)^2)/(1 - ν₀^2)
        K[9,6]=(1/12)*t^3*E₀*(0.0 + 0.75*(1 - ξ)*(-1 - ξ) + 0.75*(1 - ξ)^2)^2/(1 - ν₀^2)
        K[9,7]=(1/12)*t^3*(0.0 - 0.25*(-1 - 2*ξ)*(1 - η) - 0.25*(1 - ξ)*(1 - η))*E₀*(0.0 + 0.75*(1 - ξ)*(-1 - ξ) + 0.75*(1 - ξ)^2)/(1 - ν₀^2) + (1/12)*t^3*(0.0 - 0.25*(1 - ξ)*(-1 - 2*η) - 0.25*(1 - ξ)*(1 - η))*E₀*ν₀*(0.0 + 0.75*(1 - ξ)*(-1 - ξ) + 0.75*(1 - ξ)^2)/(1 - ν₀^2)
        K[9,8]=(1/12)*t^3*E₀*ν₀*(0.0 + 0.75*(1 - ξ)*(-1 - ξ) + 0.75*(1 - ξ)^2)*(0.0 - 0.75*(1 - η)*(-1 - η) - 0.75*(1 - η)^2)/(1 - ν₀^2)
        K[9,9]=(1/12)*t^3*E₀*(0.0 + 0.75*(1 - ξ)*(-1 - ξ) + 0.75*(1 - ξ)^2)^2/(1 - ν₀^2)
        K[9,10]=(1/12)*t^3*E₀*(0.0 + 0.25*(1 - 2*ξ)*(1 - η) - 0.25*(1 + ξ)*(1 - η))*(0.0 + 0.75*(1 - ξ)*(-1 - ξ) + 0.75*(1 - ξ)^2)/(1 - ν₀^2) + (1/12)*t^3*(0.0 - 0.25*(1 + ξ)*(-1 - 2*η) - 0.25*(1 + ξ)*(1 - η))*E₀*ν₀*(0.0 + 0.75*(1 - ξ)*(-1 - ξ) + 0.75*(1 - ξ)^2)/(1 - ν₀^2)
        K[9,11]=(1/12)*t^3*E₀*ν₀*(0.0 + 0.75*(1 - ξ)*(-1 - ξ) + 0.75*(1 - ξ)^2)*(0.0 - 0.75*(1 - η)*(-1 - η) - 0.75*(1 - η)^2)/(1 - ν₀^2)
        K[9,12]=(1/12)*t^3*E₀*(0.0 + 0.75*(1 - ξ)*(-1 - ξ) + 0.75*(1 - ξ)^2)*(0.0 - 0.75*(-1 + ξ)*(1 + ξ) - 0.75*(1 + ξ)^2)/(1 - ν₀^2)
        K[10,1]=-(0.0 + 0.25*(1 - 2*ξ)*(1 + η) - 0.25*(1 + ξ)*(1 + η))*((-1/12)*t^3*E₀*(0.0 + 0.25*(1 - 2*ξ)*(1 - η) - 0.25*(1 + ξ)*(1 - η))/(1 - ν₀^2) + (-1/12)*t^3*(0.0 - 0.25*(1 + ξ)*(-1 - 2*η) - 0.25*(1 + ξ)*(1 - η))*E₀*ν₀/(1 - ν₀^2)) - (0.0 + 0.25*(1 + ξ)*(1 - 2*η) - 0.25*(1 + ξ)*(1 + η))*((-1/12)*t^3*(0.0 - 0.25*(1 + ξ)*(-1 - 2*η) - 0.25*(1 + ξ)*(1 - η))*E₀/(1 - ν₀^2) + (-1/12)*t^3*E₀*ν₀*(0.0 + 0.25*(1 - 2*ξ)*(1 - η) - 0.25*(1 + ξ)*(1 - η))/(1 - ν₀^2)) + (1/6)*t^3*E₀*(1 - ν₀)*(0.0 + 0.125*(1 - 2*η)*(1 + η) + 0.125*(1 - 2*ξ)*(1 + ξ) + 0.125*(2 + η + ξ - η^2 - ξ^2))*(0.0 + 0.125*(1 - η)*(-1 - 2*η) - 0.125*(1 - 2*ξ)*(1 + ξ) - 0.125*(2 - η + ξ - η^2 - ξ^2))/(1 - ν₀^2)
        K[10,2]=-((-1/12)*t^3*(0.0 - 0.25*(1 + ξ)*(-1 - 2*η) - 0.25*(1 + ξ)*(1 - η))*E₀/(1 - ν₀^2) + (-1/12)*t^3*E₀*ν₀*(0.0 + 0.25*(1 - 2*ξ)*(1 - η) - 0.25*(1 + ξ)*(1 - η))/(1 - ν₀^2))*(0.0 + 0.75*(1 + η)*(-1 + η) + 0.75*(1 + η)^2)
        K[10,3]=-((-1/12)*t^3*E₀*(0.0 + 0.25*(1 - 2*ξ)*(1 - η) - 0.25*(1 + ξ)*(1 - η))/(1 - ν₀^2) + (-1/12)*t^3*(0.0 - 0.25*(1 + ξ)*(-1 - 2*η) - 0.25*(1 + ξ)*(1 - η))*E₀*ν₀/(1 - ν₀^2))*(0.0 - 0.75*(-1 + ξ)*(1 + ξ) - 0.75*(1 + ξ)^2)
        K[10,4]=-(0.0 + 0.25*(1 - ξ)*(1 - 2*η) - 0.25*(1 - ξ)*(1 + η))*((-1/12)*t^3*(0.0 - 0.25*(1 + ξ)*(-1 - 2*η) - 0.25*(1 + ξ)*(1 - η))*E₀/(1 - ν₀^2) + (-1/12)*t^3*E₀*ν₀*(0.0 + 0.25*(1 - 2*ξ)*(1 - η) - 0.25*(1 + ξ)*(1 - η))/(1 - ν₀^2)) - (0.0 - 0.25*(-1 - 2*ξ)*(1 + η) - 0.25*(1 - ξ)*(1 + η))*((-1/12)*t^3*E₀*(0.0 + 0.25*(1 - 2*ξ)*(1 - η) - 0.25*(1 + ξ)*(1 - η))/(1 - ν₀^2) + (-1/12)*t^3*(0.0 - 0.25*(1 + ξ)*(-1 - 2*η) - 0.25*(1 + ξ)*(1 - η))*E₀*ν₀/(1 - ν₀^2)) + (1/6)*t^3*E₀*(1 - ν₀)*(0.0 + 0.125*(1 - η)*(-1 - 2*η) - 0.125*(1 - 2*ξ)*(1 + ξ) - 0.125*(2 - η + ξ - η^2 - ξ^2))*(0.0 - 0.125*(1 - 2*η)*(1 + η) + 0.125*(1 - ξ)*(-1 - 2*ξ) - 0.125*(2 + η - ξ - η^2 - ξ^2))/(1 - ν₀^2)
        K[10,5]=-((-1/12)*t^3*(0.0 - 0.25*(1 + ξ)*(-1 - 2*η) - 0.25*(1 + ξ)*(1 - η))*E₀/(1 - ν₀^2) + (-1/12)*t^3*E₀*ν₀*(0.0 + 0.25*(1 - 2*ξ)*(1 - η) - 0.25*(1 + ξ)*(1 - η))/(1 - ν₀^2))*(0.0 + 0.75*(1 + η)*(-1 + η) + 0.75*(1 + η)^2)
        K[10,6]=-((-1/12)*t^3*E₀*(0.0 + 0.25*(1 - 2*ξ)*(1 - η) - 0.25*(1 + ξ)*(1 - η))/(1 - ν₀^2) + (-1/12)*t^3*(0.0 - 0.25*(1 + ξ)*(-1 - 2*η) - 0.25*(1 + ξ)*(1 - η))*E₀*ν₀/(1 - ν₀^2))*(0.0 + 0.75*(1 - ξ)*(-1 - ξ) + 0.75*(1 - ξ)^2)
        K[10,7]=-(0.0 - 0.25*(-1 - 2*ξ)*(1 - η) - 0.25*(1 - ξ)*(1 - η))*((-1/12)*t^3*E₀*(0.0 + 0.25*(1 - 2*ξ)*(1 - η) - 0.25*(1 + ξ)*(1 - η))/(1 - ν₀^2) + (-1/12)*t^3*(0.0 - 0.25*(1 + ξ)*(-1 - 2*η) - 0.25*(1 + ξ)*(1 - η))*E₀*ν₀/(1 - ν₀^2)) - (0.0 - 0.25*(1 - ξ)*(-1 - 2*η) - 0.25*(1 - ξ)*(1 - η))*((-1/12)*t^3*(0.0 - 0.25*(1 + ξ)*(-1 - 2*η) - 0.25*(1 + ξ)*(1 - η))*E₀/(1 - ν₀^2) + (-1/12)*t^3*E₀*ν₀*(0.0 + 0.25*(1 - 2*ξ)*(1 - η) - 0.25*(1 + ξ)*(1 - η))/(1 - ν₀^2)) + (1/6)*t^3*E₀*(1 - ν₀)*(0.0 - 0.125*(1 - η)*(-1 - 2*η) - 0.125*(1 - ξ)*(-1 - 2*ξ) + 0.125*(2 - η - ξ - η^2 - ξ^2))*(0.0 + 0.125*(1 - η)*(-1 - 2*η) - 0.125*(1 - 2*ξ)*(1 + ξ) - 0.125*(2 - η + ξ - η^2 - ξ^2))/(1 - ν₀^2)
        K[10,8]=-((-1/12)*t^3*(0.0 - 0.25*(1 + ξ)*(-1 - 2*η) - 0.25*(1 + ξ)*(1 - η))*E₀/(1 - ν₀^2) + (-1/12)*t^3*E₀*ν₀*(0.0 + 0.25*(1 - 2*ξ)*(1 - η) - 0.25*(1 + ξ)*(1 - η))/(1 - ν₀^2))*(0.0 - 0.75*(1 - η)*(-1 - η) - 0.75*(1 - η)^2)
        K[10,9]=-((-1/12)*t^3*E₀*(0.0 + 0.25*(1 - 2*ξ)*(1 - η) - 0.25*(1 + ξ)*(1 - η))/(1 - ν₀^2) + (-1/12)*t^3*(0.0 - 0.25*(1 + ξ)*(-1 - 2*η) - 0.25*(1 + ξ)*(1 - η))*E₀*ν₀/(1 - ν₀^2))*(0.0 + 0.75*(1 - ξ)*(-1 - ξ) + 0.75*(1 - ξ)^2)
        K[10,10]=-(0.0 - 0.25*(1 + ξ)*(-1 - 2*η) - 0.25*(1 + ξ)*(1 - η))*((-1/12)*t^3*(0.0 - 0.25*(1 + ξ)*(-1 - 2*η) - 0.25*(1 + ξ)*(1 - η))*E₀/(1 - ν₀^2) + (-1/12)*t^3*E₀*ν₀*(0.0 + 0.25*(1 - 2*ξ)*(1 - η) - 0.25*(1 + ξ)*(1 - η))/(1 - ν₀^2)) - (0.0 + 0.25*(1 - 2*ξ)*(1 - η) - 0.25*(1 + ξ)*(1 - η))*((-1/12)*t^3*E₀*(0.0 + 0.25*(1 - 2*ξ)*(1 - η) - 0.25*(1 + ξ)*(1 - η))/(1 - ν₀^2) + (-1/12)*t^3*(0.0 - 0.25*(1 + ξ)*(-1 - 2*η) - 0.25*(1 + ξ)*(1 - η))*E₀*ν₀/(1 - ν₀^2)) + (1/6)*t^3*E₀*(1 - ν₀)*(0.0 + 0.125*(1 - η)*(-1 - 2*η) - 0.125*(1 - 2*ξ)*(1 + ξ) - 0.125*(2 - η + ξ - η^2 - ξ^2))^2/(1 - ν₀^2)
        K[10,11]=-((-1/12)*t^3*(0.0 - 0.25*(1 + ξ)*(-1 - 2*η) - 0.25*(1 + ξ)*(1 - η))*E₀/(1 - ν₀^2) + (-1/12)*t^3*E₀*ν₀*(0.0 + 0.25*(1 - 2*ξ)*(1 - η) - 0.25*(1 + ξ)*(1 - η))/(1 - ν₀^2))*(0.0 - 0.75*(1 - η)*(-1 - η) - 0.75*(1 - η)^2)
        K[10,12]=-((-1/12)*t^3*E₀*(0.0 + 0.25*(1 - 2*ξ)*(1 - η) - 0.25*(1 + ξ)*(1 - η))/(1 - ν₀^2) + (-1/12)*t^3*(0.0 - 0.25*(1 + ξ)*(-1 - 2*η) - 0.25*(1 + ξ)*(1 - η))*E₀*ν₀/(1 - ν₀^2))*(0.0 - 0.75*(-1 + ξ)*(1 + ξ) - 0.75*(1 + ξ)^2)
        K[11,1]=(1/12)*t^3*E₀*(0.0 + 0.25*(1 + ξ)*(1 - 2*η) - 0.25*(1 + ξ)*(1 + η))*(0.0 - 0.75*(1 - η)*(-1 - η) - 0.75*(1 - η)^2)/(1 - ν₀^2) + (1/12)*t^3*E₀*ν₀*(0.0 + 0.25*(1 - 2*ξ)*(1 + η) - 0.25*(1 + ξ)*(1 + η))*(0.0 - 0.75*(1 - η)*(-1 - η) - 0.75*(1 - η)^2)/(1 - ν₀^2)
        K[11,2]=(1/12)*t^3*E₀*(0.0 - 0.75*(1 - η)*(-1 - η) - 0.75*(1 - η)^2)*(0.0 + 0.75*(1 + η)*(-1 + η) + 0.75*(1 + η)^2)/(1 - ν₀^2)
        K[11,3]=(1/12)*t^3*E₀*ν₀*(0.0 - 0.75*(1 - η)*(-1 - η) - 0.75*(1 - η)^2)*(0.0 - 0.75*(-1 + ξ)*(1 + ξ) - 0.75*(1 + ξ)^2)/(1 - ν₀^2)
        K[11,4]=(1/12)*t^3*E₀*(0.0 + 0.25*(1 - ξ)*(1 - 2*η) - 0.25*(1 - ξ)*(1 + η))*(0.0 - 0.75*(1 - η)*(-1 - η) - 0.75*(1 - η)^2)/(1 - ν₀^2) + (1/12)*t^3*(0.0 - 0.25*(-1 - 2*ξ)*(1 + η) - 0.25*(1 - ξ)*(1 + η))*E₀*ν₀*(0.0 - 0.75*(1 - η)*(-1 - η) - 0.75*(1 - η)^2)/(1 - ν₀^2)
        K[11,5]=(1/12)*t^3*E₀*(0.0 - 0.75*(1 - η)*(-1 - η) - 0.75*(1 - η)^2)*(0.0 + 0.75*(1 + η)*(-1 + η) + 0.75*(1 + η)^2)/(1 - ν₀^2)
        K[11,6]=(1/12)*t^3*E₀*ν₀*(0.0 + 0.75*(1 - ξ)*(-1 - ξ) + 0.75*(1 - ξ)^2)*(0.0 - 0.75*(1 - η)*(-1 - η) - 0.75*(1 - η)^2)/(1 - ν₀^2)
        K[11,7]=(1/12)*t^3*(0.0 - 0.25*(1 - ξ)*(-1 - 2*η) - 0.25*(1 - ξ)*(1 - η))*E₀*(0.0 - 0.75*(1 - η)*(-1 - η) - 0.75*(1 - η)^2)/(1 - ν₀^2) + (1/12)*t^3*(0.0 - 0.25*(-1 - 2*ξ)*(1 - η) - 0.25*(1 - ξ)*(1 - η))*E₀*ν₀*(0.0 - 0.75*(1 - η)*(-1 - η) - 0.75*(1 - η)^2)/(1 - ν₀^2)
        K[11,8]=(1/12)*t^3*E₀*(0.0 - 0.75*(1 - η)*(-1 - η) - 0.75*(1 - η)^2)^2/(1 - ν₀^2)
        K[11,9]=(1/12)*t^3*E₀*ν₀*(0.0 + 0.75*(1 - ξ)*(-1 - ξ) + 0.75*(1 - ξ)^2)*(0.0 - 0.75*(1 - η)*(-1 - η) - 0.75*(1 - η)^2)/(1 - ν₀^2)
        K[11,10]=(1/12)*t^3*(0.0 - 0.25*(1 + ξ)*(-1 - 2*η) - 0.25*(1 + ξ)*(1 - η))*E₀*(0.0 - 0.75*(1 - η)*(-1 - η) - 0.75*(1 - η)^2)/(1 - ν₀^2) + (1/12)*t^3*E₀*ν₀*(0.0 + 0.25*(1 - 2*ξ)*(1 - η) - 0.25*(1 + ξ)*(1 - η))*(0.0 - 0.75*(1 - η)*(-1 - η) - 0.75*(1 - η)^2)/(1 - ν₀^2)
        K[11,11]=(1/12)*t^3*E₀*(0.0 - 0.75*(1 - η)*(-1 - η) - 0.75*(1 - η)^2)^2/(1 - ν₀^2)
        K[11,12]=(1/12)*t^3*E₀*ν₀*(0.0 - 0.75*(1 - η)*(-1 - η) - 0.75*(1 - η)^2)*(0.0 - 0.75*(-1 + ξ)*(1 + ξ) - 0.75*(1 + ξ)^2)/(1 - ν₀^2)
        K[12,1]=(1/12)*t^3*E₀*(0.0 + 0.25*(1 - 2*ξ)*(1 + η) - 0.25*(1 + ξ)*(1 + η))*(0.0 - 0.75*(-1 + ξ)*(1 + ξ) - 0.75*(1 + ξ)^2)/(1 - ν₀^2) + (1/12)*t^3*E₀*ν₀*(0.0 + 0.25*(1 + ξ)*(1 - 2*η) - 0.25*(1 + ξ)*(1 + η))*(0.0 - 0.75*(-1 + ξ)*(1 + ξ) - 0.75*(1 + ξ)^2)/(1 - ν₀^2)
        K[12,2]=(1/12)*t^3*E₀*ν₀*(0.0 + 0.75*(1 + η)*(-1 + η) + 0.75*(1 + η)^2)*(0.0 - 0.75*(-1 + ξ)*(1 + ξ) - 0.75*(1 + ξ)^2)/(1 - ν₀^2)
        K[12,3]=(1/12)*t^3*E₀*(0.0 - 0.75*(-1 + ξ)*(1 + ξ) - 0.75*(1 + ξ)^2)^2/(1 - ν₀^2)
        K[12,4]=(1/12)*t^3*(0.0 - 0.25*(-1 - 2*ξ)*(1 + η) - 0.25*(1 - ξ)*(1 + η))*E₀*(0.0 - 0.75*(-1 + ξ)*(1 + ξ) - 0.75*(1 + ξ)^2)/(1 - ν₀^2) + (1/12)*t^3*E₀*ν₀*(0.0 + 0.25*(1 - ξ)*(1 - 2*η) - 0.25*(1 - ξ)*(1 + η))*(0.0 - 0.75*(-1 + ξ)*(1 + ξ) - 0.75*(1 + ξ)^2)/(1 - ν₀^2)
        K[12,5]=(1/12)*t^3*E₀*ν₀*(0.0 + 0.75*(1 + η)*(-1 + η) + 0.75*(1 + η)^2)*(0.0 - 0.75*(-1 + ξ)*(1 + ξ) - 0.75*(1 + ξ)^2)/(1 - ν₀^2)
        K[12,6]=(1/12)*t^3*E₀*(0.0 + 0.75*(1 - ξ)*(-1 - ξ) + 0.75*(1 - ξ)^2)*(0.0 - 0.75*(-1 + ξ)*(1 + ξ) - 0.75*(1 + ξ)^2)/(1 - ν₀^2)
        K[12,7]=(1/12)*t^3*(0.0 - 0.25*(-1 - 2*ξ)*(1 - η) - 0.25*(1 - ξ)*(1 - η))*E₀*(0.0 - 0.75*(-1 + ξ)*(1 + ξ) - 0.75*(1 + ξ)^2)/(1 - ν₀^2) + (1/12)*t^3*(0.0 - 0.25*(1 - ξ)*(-1 - 2*η) - 0.25*(1 - ξ)*(1 - η))*E₀*ν₀*(0.0 - 0.75*(-1 + ξ)*(1 + ξ) - 0.75*(1 + ξ)^2)/(1 - ν₀^2)
        K[12,8]=(1/12)*t^3*E₀*ν₀*(0.0 - 0.75*(1 - η)*(-1 - η) - 0.75*(1 - η)^2)*(0.0 - 0.75*(-1 + ξ)*(1 + ξ) - 0.75*(1 + ξ)^2)/(1 - ν₀^2)
        K[12,9]=(1/12)*t^3*E₀*(0.0 + 0.75*(1 - ξ)*(-1 - ξ) + 0.75*(1 - ξ)^2)*(0.0 - 0.75*(-1 + ξ)*(1 + ξ) - 0.75*(1 + ξ)^2)/(1 - ν₀^2)
        K[12,10]=(1/12)*t^3*E₀*(0.0 + 0.25*(1 - 2*ξ)*(1 - η) - 0.25*(1 + ξ)*(1 - η))*(0.0 - 0.75*(-1 + ξ)*(1 + ξ) - 0.75*(1 + ξ)^2)/(1 - ν₀^2) + (1/12)*t^3*(0.0 - 0.25*(1 + ξ)*(-1 - 2*η) - 0.25*(1 + ξ)*(1 - η))*E₀*ν₀*(0.0 - 0.75*(-1 + ξ)*(1 + ξ) - 0.75*(1 + ξ)^2)/(1 - ν₀^2)
        K[12,11]=(1/12)*t^3*E₀*ν₀*(0.0 - 0.75*(1 - η)*(-1 - η) - 0.75*(1 - η)^2)*(0.0 - 0.75*(-1 + ξ)*(1 + ξ) - 0.75*(1 + ξ)^2)/(1 - ν₀^2)
        K[12,12]=(1/12)*t^3*E₀*(0.0 - 0.75*(-1 + ξ)*(1 + ξ) - 0.75*(1 + ξ)^2)^2/(1 - ν₀^2)

        J[1,1]=(-1/4)*(1 - η)*x₁ + (1/4)*(1 - η)*x₃ + (-1/4)*(1 + η)*x₂ + (1/4)*(1 + η)*x₄
        J[1,2]=(-1/4)*(1 - η)*y₂ + (1/4)*(1 - η)*y₃ + (-1/4)*(1 + η)*y₂ + (1/4)*(1 + η)*y₄
        J[2,1]=(-1/4)*(1 - ξ)*x₁ + (1/4)*(1 - ξ)*x₂ + (-1/4)*(1 + ξ)*x₃ + (1/4)*(1 + ξ)*x₄
        J[2,2]=(-1/4)*(1 + ξ)*y₃ + (1/4)*(1 + ξ)*y₄

        return K*det(J)
    end
    elm.Kbᵉ=sparse(hcubature(BtDB,[-1,1],[1,1])[1])
end

function integrateK!(elm::Quad)
    membrane,bending=elm.membrane,elm.bending
    Kᵉ=spzeros(24,24)
    if membrane
        I=1:8
        J=[1,2,7,8,13,14,19,20]
        L=sparse(I,J,1.,8,24)
        Km=integrateKm!(elm)
        Kᵉ+=L'*Km*L
    end
    if bending
        I=1:12
        J=[3,4,5,9,10,11,15,16,17,21,22,23]
        L=sparse(I,J,1.,12,24)
        Kb=integrateKb!(elm)
        Kᵉ+=L'*Kb*L
    end
    elm.Kᵉ=Kᵉ
end

function integrateKσ(elm::Quad,σ)
    E₀,ν₀=elm.material.E,elm.material.ν
    center=elm.center
    t=elm.t
    T=elm.T[1:3,1:3]
    x₁,y₁,z₁=T*(elm.node1.loc-center)
    x₂,y₂,z₂=T*(elm.node2.loc-center)
    x₃,y₃,z₃=T*(elm.node3.loc-center)
    x₄,y₄,z₄=T*(elm.node4.loc-center)
    K=Matrix{Float64}(undef,8,8)
    J=Matrix{Float64}(undef,2,2)

    o=(node1.loc+node2.loc+node3.loc+node4.loc)/4
    n1=node1.loc+[u[1];u[2];0]
    n2=node2.loc+[u[3];u[4];0]
    n3=node3.loc+[u[5];u[6];0]
    n4=node4.loc+[u[7];u[8];0]
    pt1 = n1+n2
    pt2 = n2+n3
    csys = CSys(o, pt1, pt2)
    V=csys.T
    T̄ᵉ=zeros(8,8)
    T̄ᵉ[1:2,1:2]=V
    T̄ᵉ[3:4,3:4]=V
    T̄ᵉ[5:6,5:6]=V
    T̄ᵉ[7:8,7:8]=V


    function GtΣG(ξ,η)
        σ[1,1]= G*(-1 + (1/16)*(1 - ξ)^2*(1 - η)^2 + (1/16)*(1 - ξ)^2*(1 + η)^2 + (1/16)*(1 + ξ)^2*(1 - η)^2 + (1/16)*(1 + ξ)^2*(1 + η)^2) + (1/2)*(-1 + (1/16)*(1 - ξ)^2*(1 - η)^2 + (1/16)*(1 - ξ)^2*(1 + η)^2 + (1/16)*(1 + ξ)^2*(1 - η)^2 + (1/16)*(1 + ξ)^2*(1 + η)^2)*λ
        σ[2,2]= G*(-1 + (1/16)*(1 - ξ)^2*(1 - η)^2 + (1/16)*(1 - ξ)^2*(1 + η)^2 + (1/16)*(1 + ξ)^2*(1 - η)^2 + (1/16)*(1 + ξ)^2*(1 + η)^2) + (1/2)*(-1 + (1/16)*(1 - ξ)^2*(1 - η)^2 + (1/16)*(1 - ξ)^2*(1 + η)^2 + (1/16)*(1 + ξ)^2*(1 - η)^2 + (1/16)*(1 + ξ)^2*(1 + η)^2)*λ

        Σᵉ=[σ[1,1] 0;
            0 σ[2,2]]

        G=       [0  (-1/4)*(1 - η)              0  (-1/4)*(1 + η)               0  (1/4)*(1 - η)              0  (1/4)*(1 + η);
     (-1/4)*(1 - ξ)               0  (1/4)*(1 - ξ)               0  (-1/4)*(1 + ξ)              0  (1/4)*(1 + ξ)              0]

        J[1,1]=(-1/4)*(1 - η)*x₁ + (1/4)*(1 - η)*x₃ + (-1/4)*(1 + η)*x₂ + (1/4)*(1 + η)*x₄
        J[1,2]=(-1/4)*(1 - η)*y₂ + (1/4)*(1 - η)*y₃ + (-1/4)*(1 + η)*y₂ + (1/4)*(1 + η)*y₄
        J[2,1]=(-1/4)*(1 - ξ)*x₁ + (1/4)*(1 - ξ)*x₂ + (-1/4)*(1 + ξ)*x₃ + (1/4)*(1 + ξ)*x₄
        J[2,2]=(-1/4)*(1 + ξ)*y₃ + (1/4)*(1 + ξ)*y₄
        Gᵉ'*Σᵉ*Gᵉ*det(J)
    end
    Kσ=hquadrature(GtΣG,[-1,1],[1,1])
end

function integrateKu(elm::Quad,u)
    E₀,ν₀=elm.material.E,elm.material.ν
    center=elm.center
    t=elm.t
    T=elm.T[1:3,1:3]
    x₁,y₁,z₁=T*(elm.node1.loc-center)
    x₂,y₂,z₂=T*(elm.node2.loc-center)
    x₃,y₃,z₃=T*(elm.node3.loc-center)
    x₄,y₄,z₄=T*(elm.node4.loc-center)
    K=Matrix{Float64}(undef,8,8)
    J=Matrix{Float64}(undef,2,2)

    o=(node1.loc+node2.loc+node3.loc+node4.loc)/4
    n1=node1.loc+[u[1];u[2];0]
    n2=node2.loc+[u[3];u[4];0]
    n3=node3.loc+[u[5];u[6];0]
    n4=node4.loc+[u[7];u[8];0]
    pt1 = n1+n2
    pt2 = n2+n3
    csys = CSys(o, pt1, pt2)
    V=csys.T
    T̄ᵉ=zeros(8,8)
    T̄ᵉ[1:2,1:2]=V
    T̄ᵉ[3:4,3:4]=V
    T̄ᵉ[5:6,5:6]=V
    T̄ᵉ[7:8,7:8]=V
end

# function integrateK(elm,p_delta=false,σ=nothing,large_deform=false,u=nothing)
#     K=integrateK(elm)
#     if p_delta
#         K+=integrateKσ(elm,σ)
#     elseif large_deform
#         K+=integrateKu(elm,u)
#     end
#     return K
# end

function integrateM!(elm::Quad)
    membrane,bending=elm.membrane,elm.bending
    ρ=elm.material.ρ
    center=elm.center
    t=elm.t
    T=elm.T[1:3,1:3]
    x₁,y₁,z₁=T*(elm.node1.loc-center)
    x₂,y₂,z₂=T*(elm.node2.loc-center)
    x₃,y₃,z₃=T*(elm.node3.loc-center)
    x₄,y₄,z₄=T*(elm.node4.loc-center)
    M=Matrix{Float64}(undef,24,24)
    J=Matrix{Float64}(undef,2,2)
    function ρNtN(x)
        ξ,η=x[1],x[2]
        # include(joinpath(dirname(@__FILE__),"jacobi.jl"))
        J[1,1]=(-1/4)*(1 - η)*x₁ + (1/4)*(1 - η)*x₃ + (-1/4)*(1 + η)*x₂ + (1/4)*(1 + η)*x₄
        J[1,2]=(-1/4)*(1 - η)*y₂ + (1/4)*(1 - η)*y₃ + (-1/4)*(1 + η)*y₂ + (1/4)*(1 + η)*y₄
        J[2,1]=(-1/4)*(1 - ξ)*x₁ + (1/4)*(1 - ξ)*x₂ + (-1/4)*(1 + ξ)*x₃ + (1/4)*(1 + ξ)*x₄
        J[2,2]=(-1/4)*(1 + ξ)*y₃ + (1/4)*(1 + ξ)*y₄

        M*det(J)
    end
    elm.Mᵉ=sparse(hcubature(ρNtN,[-1,1],[1,1])[1])*t
end

function integrateP(elm,elm_force)
    N=elm.N
    B=elm.B
    D=elm.D
    J=elm.J

    f,s,σ₀,ϵ₀=elmforce.f,elmforce.s,elmforce.σ₀,elmforce.ϵ₀
    a=[-1 -1]
    b=[1 1]

    function f1(x)
        N'*f*det(J)
    end

    function f2(x)
        N'*s*det(J)
    end

    function f3(x)
        x->B'*σ₀*det(J)
    end

    function f4(x)
        x->B'*D*ϵ₀*det(J)
    end

    Pᵉ_f=hquadrature(f1,a,b)
    Pᵉ_s=hquadrature(f2,[-1],[1])#ξ=-1
    Pᵉ_σ₀=hquadrature(f3,a,b)
    Pᵉ_ϵ₀=hquadrature(f4,a,b)

    Pᵉ_f,Pᵉ_s,Pᵉ_σ₀,Pᵉ_ϵ₀=calc_force(elm,elm_force) #Pᵉ=Pᵉf+Pᵉs+Pᵉσ₀+Pᵉϵ₀
    Pᵉ=Pᵉ_f+Pᵉ_s+Pᵉ_σ₀+Pᵉ_ϵ₀
end

end
